window.onload=function(s){smash.init()};var smash={init:function(){var s=document.querySelector(".smash-searchbox input");s&&(s.onfocus=function(){smash.addClass(document.querySelector(".smash-header"),"is-focussed")},s.onblur=function(){smash.removeClass(document.querySelector(".smash-header"),"is-focussed")});var t=document.querySelector(".smash-icon-bar .lock");t&&(t.onclick=function(){smash.toggleClass(this,"unlock"),smash.toggleClass(document.querySelector(".smash-icon-bar"),"is-unlocked")});var a=document.querySelector(".smash-icon-bar");a&&smash.addClass(a,"is-unlocked")},addClass:function(s,t){s.classList?s.classList.add(t):s.className+=" "+t},removeClass:function(s,t){s.classList?s.classList.remove(t):s.className=s.className.replace(t,"")},hasClass:function(s,t){return(" "+s.className+" ").replace(/[\n\t]/g," ").indexOf(" "+t+" ")>-1},toggleClass:function(s,t){smash.hasClass(s,t)?smash.removeClass(s,t):smash.addClass(s,t)}};smash.router={__parseRouteRegex:/{(.*?)}/gi,__dynamicParts:[],__routes:{static:[],dynamic:[]}},smash.router.add=function(s,t){var a=smash.router.parseRoute(s);return a.regex?(a.callback=t,smash.router.__routes.dynamic[a.depth]||(smash.router.__routes.dynamic[a.depth]=[]),smash.router.__routes.dynamic[a.depth][a.numVars]||(smash.router.__routes.dynamic[a.depth][a.numVars]=[]),void smash.router.__routes.dynamic[a.depth][a.numVars].push(a)):void(smash.router.__routes.static[s]=t)},smash.router.set=function(s){window.history.pushState("","",s),window.dispatchEvent(new Event("popstate"))},smash.router.redirect=function(s){window.location=s},smash.router.handleNotFound=function(s){console.log("route: "+JSON.stringify(s)+" does not exist")},smash.router.run=function(){window.onpopstate=function(s){smash.router.execute()},smash.router.execute()},smash.router.execute=function(){var s=this.getPath();if(this.__routes.static[s.path])return void this.__routes.static[s.path]();var t=s.path.split("/").length-1;if(this.__routes.dynamic[t]){var a,e,r={};for(var o in this.__routes.dynamic[t])for(var n in this.__routes.dynamic[t][o]){var a=this.__routes.dynamic[t][o][n];if(e=s.path.match(a.regex)){for(var u=0;u<a.numVars;u++)r[a.vars[u]]=e[u+1];return void a.callback(r)}}}smash.router.handleNotFound(s)},smash.router.getPath=function(){var s=document.createElement("a");return s.href=window.location,{host:s.hostname,path:s.pathname}},smash.router.parseRoute=function(s){"/"!=s.substring(0,1)&&(s="/"+s),"/"==s.substring(s.length-2)&&(s="/"+s);var t={path:s,depth:s.split("/").length-1,vars:[],numVars:0};if(smash.router.__dynamicParts=s.match(smash.router.__parseRouteRegex),void 0!=smash.router.__dynamicParts&&null!=smash.router.__dynamicParts){for(var a="^"+s.replace(/\//gi,"\\/")+"$",e=0;e<smash.router.__dynamicParts.length;e++)t.numVars++,t.vars.push(smash.router.__dynamicParts[e].substring(1,smash.router.__dynamicParts[e].length-1)),a=a.replace(smash.router.__dynamicParts[e],"(.*?)");t.regex=new RegExp(a,"i")}return t};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNtYXNoLmpzIiwicm91dGVyLmpzIl0sIm5hbWVzIjpbIndpbmRvdyIsIm9ubG9hZCIsImUiLCJzbWFzaCIsImluaXQiLCJzYiIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIm9uZm9jdXMiLCJhZGRDbGFzcyIsIm9uYmx1ciIsInJlbW92ZUNsYXNzIiwiaWJsIiwib25jbGljayIsInRvZ2dsZUNsYXNzIiwidGhpcyIsImliIiwiZWwiLCJjbGFzc05hbWUiLCJjbGFzc0xpc3QiLCJhZGQiLCJyZW1vdmUiLCJyZXBsYWNlIiwiaGFzQ2xhc3MiLCJpbmRleE9mIiwicm91dGVyIiwiX19wYXJzZVJvdXRlUmVnZXgiLCJfX2R5bmFtaWNQYXJ0cyIsIl9fcm91dGVzIiwic3RhdGljIiwiZHluYW1pYyIsInBhdGgiLCJjYWxsYmFjayIsInJvdXRlIiwicGFyc2VSb3V0ZSIsInJlZ2V4IiwiZGVwdGgiLCJudW1WYXJzIiwicHVzaCIsInNldCIsImhpc3RvcnkiLCJwdXNoU3RhdGUiLCJkaXNwYXRjaEV2ZW50IiwiRXZlbnQiLCJyZWRpcmVjdCIsImxvY2F0aW9uIiwiaGFuZGxlTm90Rm91bmQiLCJjb25zb2xlIiwibG9nIiwiSlNPTiIsInN0cmluZ2lmeSIsInJ1biIsIm9ucG9wc3RhdGUiLCJldmVudCIsImV4ZWN1dGUiLCJnZXRQYXRoIiwic3BsaXQiLCJsZW5ndGgiLCJtYXRjaGVzIiwiZGF0YSIsInZhck51bSIsIml0ZW0iLCJtYXRjaCIsImkiLCJ2YXJzIiwibCIsImNyZWF0ZUVsZW1lbnQiLCJocmVmIiwiaG9zdCIsImhvc3RuYW1lIiwicGF0aG5hbWUiLCJzdWJzdHJpbmciLCJ1bmRlZmluZWQiLCJSZWdFeHAiXSwibWFwcGluZ3MiOiJBQUFBQSxPQUFBQyxPQUFBLFNBQUFDLEdBQ0FDLE1BQUFDLE9BR0EsSUFBQUQsUUFDQUMsS0FBQSxXQUNBLEdBQUFDLEdBQUFDLFNBQUFDLGNBQUEseUJBQ0FGLEtBQ0FBLEVBQUFHLFFBQUEsV0FDQUwsTUFBQU0s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ZSI6InNtYXNoLmpzIiwic291cmNlc0NvbnRlbnQiOlsid2luZG93Lm9ubG9hZCA9IGZ1bmN0aW9uKGUpe1xuICAgIHNtYXNoLmluaXQoKTtcbn1cblxudmFyIHNtYXNoID0ge1xuICAgIGluaXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNtYXNoLXNlYXJjaGJveCBpbnB1dFwiKTtcbiAgICAgICAgaWYgKHNiKSB7XG4gICAgICAgICAgICBzYi5vbmZvY3VzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgc21hc2guYWRkQ2xhc3MoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zbWFzaC1oZWFkZXJcIiksICdpcy1mb2N1c3NlZCcpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHNiLm9uYmx1ciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHNtYXNoLnJlbW92ZUNsYXNzKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc21hc2gtaGVhZGVyXCIpLCAnaXMtZm9jdXNzZWQnKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGlibCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc21hc2gtaWNvbi1iYXIgLmxvY2tcIik7XG4gICAgICAgIGlmIChpYmwpIHtcbiAgICAgICAgICAgIGlibC5vbmNsaWNrID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgc21hc2gudG9nZ2xlQ2xhc3ModGhpcywgJ3VubG9jaycpO1xuICAgICAgICAgICAgICAgIHNtYXNoLnRvZ2dsZUNsYXNzKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc21hc2gtaWNvbi1iYXJcIiksICdpcy11bmxvY2tlZCcpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaWIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNtYXNoLWljb24tYmFyXCIpO1xuICAgICAgICBpZiAoaWIpIHtcbiAgICAgICAgICAgIHNtYXNoLmFkZENsYXNzKGliLCAnaXMtdW5sb2NrZWQnKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgYWRkQ2xhc3M6IGZ1bmN0aW9uKGVsLCBjbGFzc05hbWUpIHtcbiAgICAgICAgZWwuY2xhc3NMaXN0ID8gZWwuY2xhc3NMaXN0LmFkZChjbGFzc05hbWUpIDogZWwuY2xhc3NOYW1lICs9ICgnICcgKyBjbGFzc05hbWUpO1xuICAgIH0sXG4gICAgcmVtb3ZlQ2xhc3M6IGZ1bmN0aW9uKGVsLCBjbGFzc05hbWUpIHtcbiAgICAgICAgZWwuY2xhc3NMaXN0ID8gZWwuY2xhc3NMaXN0LnJlbW92ZShjbGFzc05hbWUpIDogZWwuY2xhc3NOYW1lID0gZWwuY2xhc3NOYW1lLnJlcGxhY2UoY2xhc3NOYW1lLCAnJyk7XG4gICAgfSxcbiAgICBoYXNDbGFzczogZnVuY3Rpb24oZWwsIGNsYXNzTmFtZSkge1xuICAgICAgICByZXR1cm4gKChcIiBcIiArIGVsLmNsYXNzTmFtZSArIFwiIFwiKS5yZXBsYWNlKC9bXFxuXFx0XS9nLCBcIiBcIikuaW5kZXhPZihcIiBcIiArIGNsYXNzTmFtZSArIFwiIFwiKSA+IC0xKTtcbiAgICB9LFxuICAgIHRvZ2dsZUNsYXNzOiBmdW5jdGlvbihlbCwgY2xhc3NOYW1lKSB7XG4gICAgICAgIHNtYXNoLmhhc0NsYXNzKGVsLCBjbGFzc05hbWUpID8gc21hc2gucmVtb3ZlQ2xhc3MoZWwsIGNsYXNzTmFtZSkgOiBzbWFzaC5hZGRDbGFzcyhlbCwgY2xhc3NOYW1lKTtcbiAgICB9XG59O1xuIiwic21hc2gucm91dGVyID0ge1xuICAgIF9fcGFyc2VSb3V0ZVJlZ2V4OiAveyguKj8pfS9pZyxcbiAgICBfX2R5bmFtaWNQYXJ0czogW10sXG4gICAgX19yb3V0ZXM6IHtcbiAgICAgICAgc3RhdGljOiBbXSxcbiAgICAgICAgZHluYW1pYzogW11cbiAgICB9XG59O1xuXG5zbWFzaC5yb3V0ZXIuYWRkID0gZnVuY3Rpb24ocGF0aCwgY2FsbGJhY2spIHtcbiAgICB2YXIgcm91dGUgPSBzbWFzaC5yb3V0ZXIucGFyc2VSb3V0ZShwYXRoKTtcbiAgICBpZiAocm91dGUucmVnZXgpIHtcbiAgICAgICAgcm91dGUuY2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgICAgICAgaWYgKCFzbWFzaC5yb3V0ZXIuX19yb3V0ZXMuZHluYW1pY1tyb3V0ZS5kZXB0aF0pIHtcbiAgICAgICAgICAgIHNtYXNoLnJvdXRlci5fX3JvdXRlcy5keW5hbWljW3JvdXRlLmRlcHRoXSA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIGlmICghc21hc2gucm91dGVyLl9fcm91dGVzLmR5bmFtaWNbcm91dGUuZGVwdGhdW3JvdXRlLm51bVZhcnNdKSB7XG4gICAgICAgICAgICBzbWFzaC5yb3V0ZXIuX19yb3V0ZXMuZHluYW1pY1tyb3V0ZS5kZXB0aF1bcm91dGUubnVtVmFyc10gPSBbXTtcbiAgICAgICAgfVxuICAgICAgICBzbWFzaC5yb3V0ZXIuX19yb3V0ZXMuZHluYW1pY1tyb3V0ZS5kZXB0aF1bcm91dGUubnVtVmFyc10ucHVzaChyb3V0ZSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgc21hc2gucm91dGVyLl9fcm91dGVzLnN0YXRpY1twYXRoXSA9IGNhbGxiYWNrO1xufTtcblxuc21hc2gucm91dGVyLnNldCA9IGZ1bmN0aW9uKHJvdXRlKSB7XG4gICAgd2luZG93Lmhpc3RvcnkucHVzaFN0YXRlKFwiXCIsIFwiXCIsIHJvdXRlKTtcbiAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3BvcHN0YXRlJykpO1xufTtcblxuc21hc2gucm91dGVyLnJlZGlyZWN0ID0gZnVuY3Rpb24ocm91dGUpIHtcbiAgICB3aW5kb3cubG9jYXRpb24gPSByb3V0ZTtcbn07XG5cbnNtYXNoLnJvdXRlci5oYW5kbGVOb3RGb3VuZCA9IGZ1bmN0aW9uKHJvdXRlKSB7XG4gICAgY29uc29sZS5sb2coXCJyb3V0ZTogXCIgKyBKU09OLnN0cmluZ2lmeShyb3V0ZSkgKyBcIiBkb2VzIG5vdCBleGlzdFwiKTtcbn07XG5cbnNtYXNoLnJvdXRlci5ydW4gPSBmdW5jdGlvbigpIHtcbiAgICB3aW5kb3cub25wb3BzdGF0ZSA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgIHNtYXNoLnJvdXRlci5leGVjdXRlKCk7XG4gICAgfTtcbiAgICBzbWFzaC5yb3V0ZXIuZXhlY3V0ZSgpO1xufVxuXG5zbWFzaC5yb3V0ZXIuZXhlY3V0ZSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBwYXRoID0gdGhpcy5nZXRQYXRoKCk7XG4gICAgaWYgKHRoaXMuX19yb3V0ZXMuc3RhdGljW3BhdGgucGF0aF0pIHtcbiAgICAgICAgdGhpcy5fX3JvdXRlcy5zdGF0aWNbcGF0aC5wYXRoXSgpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBkZXB0aCA9IHBhdGgucGF0aC5zcGxpdChcIi9cIikubGVuZ3RoLTE7XG4gICAgaWYgKHRoaXMuX19yb3V0ZXMuZHluYW1pY1tkZXB0aF0pIHtcbiAgICAgICAgdmFyIHJvdXRlO1xuICAgICAgICB2YXIgbWF0Y2hlcztcbiAgICAgICAgdmFyIGRhdGEgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgdmFyTnVtIGluIHRoaXMuX19yb3V0ZXMuZHluYW1pY1tkZXB0aF0pIHtcbiAgICAgICAgICAgIGZvciAodmFyIGl0ZW0gaW4gdGhpcy5fX3JvdXRlcy5keW5hbWljW2RlcHRoXVt2YXJOdW1dKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJvdXRlID0gdGhpcy5fX3JvdXRlcy5keW5hbWljW2RlcHRoXVt2YXJOdW1dW2l0ZW1dO1xuICAgICAgICAgICAgICAgIG1hdGNoZXMgPSBwYXRoLnBhdGgubWF0Y2gocm91dGUucmVnZXgpO1xuICAgICAgICAgICAgICAgIGlmICghbWF0Y2hlcykge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaT0wOyBpPHJvdXRlLm51bVZhcnM7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBkYXRhW3JvdXRlLnZhcnNbaV1dID0gbWF0Y2hlc1tpKzFdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByb3V0ZS5jYWxsYmFjayhkYXRhKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgc21hc2gucm91dGVyLmhhbmRsZU5vdEZvdW5kKHBhdGgpO1xufTtcblxuc21hc2gucm91dGVyLmdldFBhdGggPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJhXCIpO1xuICAgIGwuaHJlZiA9IHdpbmRvdy5sb2NhdGlvbjtcbiAgICByZXR1cm4ge2hvc3Q6IGwuaG9zdG5hbWUsIHBhdGg6IGwucGF0aG5hbWV9O1xufTtcblxuc21hc2gucm91dGVyLnBhcnNlUm91dGUgPSBmdW5jdGlvbihwYXRoKSB7XG4gICAgaWYgKHBhdGguc3Vic3RyaW5nKDAsMSkgIT0gXCIvXCIpIHtcbiAgICAgICAgcGF0aCA9IFwiL1wiICsgcGF0aDtcbiAgICB9XG4gICAgaWYgKHBhdGguc3Vic3RyaW5nKHBhdGgubGVuZ3RoLTIpID09IFwiL1wiKSB7XG4gICAgICAgIHBhdGggPSBcIi9cIiArIHBhdGg7XG4gICAgfVxuICAgIHZhciByb3V0ZSA9IHtcbiAgICAgICAgcGF0aDogcGF0aCxcbiAgICAgICAgZGVwdGg6IChwYXRoLnNwbGl0KFwiL1wiKS5sZW5ndGggLSAxKSxcbiAgICAgICAgdmFyczogW10sXG4gICAgICAgIG51bVZhcnM6IDBcbiAgICB9O1xuICAgIHNtYXNoLnJvdXRlci5fX2R5bmFtaWNQYXJ0cyA9IHBhdGgubWF0Y2goc21hc2gucm91dGVyLl9fcGFyc2VSb3V0ZVJlZ2V4KTtcbiAgICBpZiAoc21hc2gucm91dGVyLl9fZHluYW1pY1BhcnRzICE9IHVuZGVmaW5lZCAmJiBzbWFzaC5yb3V0ZXIuX19keW5hbWljUGFydHMgIT0gbnVsbCkge1xuICAgICAgICB2YXIgcmVnZXggPSBcIl5cIiArIHBhdGgucmVwbGFjZSgvXFwvL2lnLCBcIlxcXFwvXCIpICsgXCIkXCI7XG4gICAgICAgIGZvciAodmFyIGk9MDsgaTxzbWFzaC5yb3V0ZXIuX19keW5hbWljUGFydHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHJvdXRlLm51bVZhcnMrKztcbiAgICAgICAgICAgIHJvdXRlLnZhcnMucHVzaChzbWFzaC5yb3V0ZXIuX19keW5hbWljUGFydHNbaV0uc3Vic3RyaW5nKDEsIHNtYXNoLnJvdXRlci5fX2R5bmFtaWNQYXJ0c1tpXS5sZW5ndGgtMSkpO1xuICAgICAgICAgICAgcmVnZXggPSByZWdleC5yZXBsYWNlKHNtYXNoLnJvdXRlci5fX2R5bmFtaWNQYXJ0c1tpXSwgXCIoLio/KVwiKTtcbiAgICAgICAgfVxuICAgICAgICByb3V0ZS5yZWdleCA9IG5ldyBSZWdFeHAocmVnZXgsICdpJyk7XG4gICAgfVxuICAgIHJldHVybiByb3V0ZTtcbn07XG4iXX0=
