window.addEventListener("load",function(e){smash.init()},!1);var smash={};smash.init=function(){smash.config.init(),smash.sidebar.init(),smash.searchbox.init(),smash.workspace.init(),smash.input.init()},smash.get=function(e,s){try{return e.querySelector(s)}catch(e){console.log(e)}},smash.getAll=function(e,s){try{return e.querySelectorAll(s)}catch(e){console.log(e)}},smash.hide=function(e,s){for(var a=smash.getAll(e,s),t=0;t<a.length;t++)a[t].style.display="none"},smash.show=function(e,s){for(var a=smash.getAll(e,s),t=0;t<a.length;t++)a[t].style.display=""},smash.on=function(e,s,a,t){for(var n=smash.getAll(e,s),r=0;r<n.length;r++)n[r][a]=t},smash.ajax={_headers_:[]},smash.ajax.addHeader=function(e,s){smash.ajax._headers_[e]=s},smash.ajax.removeHeader=function(e){delete smash.ajax._headers_[e]},smash.ajax.onerror=function(e){console.log(e)},smash.ajax.onunauthorized=function(e){smash.ajax.onerror(e)},smash.ajax._xhr_=function(){if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;for(var e,s=["MSXML2.XmlHttp.6.0","MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"],a=0;a<s.length;a++)try{e=new ActiveXObject(s[a]);break}catch(e){}return e},smash.ajax.send=function(e,s,a,t,n,r){void 0===r&&(r=!0);var o=smash.ajax._xhr_();o.responseType=n,o.onreadystatechange=function(){if(4==o.readyState)switch(o.status){case 200:case 201:s&&s(o.response);break;case 401:smash.ajax.onunauthorized(o.response);break;default:smash.ajax.onerror(o.response)}},o.open(a,e,r),"json"==n?o.setRequestHeader("Content-type","application/json"):"POST"==a&&o.setRequestHeader("Content-type","application/x-www-form-urlencoded");for(var i in smash.ajax._headers_)o.setRequestHeader(i,smash.ajax._headers_[i]);o.send(t)},smash.ajax.get=function(e,s,a,t,n){var r=[];for(var o in a)r.push(encodeURIComponent(o)+"="+encodeURIComponent(a[o]));smash.ajax.send(e+(r.length?"?"+r.join("&"):""),s,"GET",null,t,n)},smash.ajax.post=function(e,s,a,t,n){var r;if(a)if("json"!=t){var o=[];for(var i in a)o.push(encodeURIComponent(i)+"="+encodeURIComponent(a[i]));r=o.join("&")}else r=JSON.stringify(a);smash.ajax.send(e,s,"POST",r,t,n)},smash.class={},smash.class.add=function(e,s){smash.class.has(e,s)||(e.classList?e.classList.add(s):e.className+=" "+s)},smash.class.remove=function(e,s){smash.class.has(e,s)&&(e.classList?e.classList.remove(s):e.className=e.className.replace(s,""))},smash.class.has=function(e,s){return(" "+e.className+" ").replace(/[\n\t]/g," ").indexOf(" "+s+" ")>-1},smash.class.toggle=function(e,s){smash.class.has(e,s)?smash.class.remove(e,s):smash.class.add(e,s)},smash.config={_values_:{_sidebar_lock_:!1}},smash.config.init=function(){var e=smash.storage.get("config");e&&(smash.config._values_=e)},smash.config.get=function(e){var s="_"+e+"_";if(s in smash.config._values_)return smash.config._values_[s];throw new smash.Exception("001",'Invalid config option "'+e+'"')},smash.config.set=function(e,s){var a="_"+e+"_";if(!a in smash.config._values_)throw new smash.Exception("001",'Invalid config option "'+e+'"');smash.config._values_[a]=s,smash.storage.set("config",smash.config._values_)},smash.dialog={},smash.dialog.new=function(e){var s=smash.dialog.checkBackdrop(),a=document.createElement("div");a.className="smash-dialog",a.innerHTML=e,s.appendChild(a)},smash.dialog.checkBackdrop=function(){if(e=smash.get(document,".smash-dialog-backdrop"))return(dialog=smash.get(document,".smash-dialog-backdrop .smash-dialog"))&&e.removeChild(dialog),e;var e=document.createElement("div");return e.className="smash-dialog-backdrop",e.innerHTML='<div class="smash-dialog-background"></div>',smash.get(e,".smash-dialog-background").onclick=smash.dialog.close,smash.get(document,"body").appendChild(e),e},smash.dialog.close=function(){(dialog=smash.get(document,".smash-dialog-backdrop"))&&smash.get(document,"body").removeChild(dialog)},smash.Exception=function(e,s){this.value=e,this.message=s,this.toString=function(){return"SmashException "+this.value+": "+this.message}},smash.input={},smash.input.init=function(){for(var e,s=document.querySelectorAll(".smash-input input, .smash-textarea textarea"),a=0;a<s.length;a++)if(e=s[a],!smash.class.has(e.parentElement,"smash-initialised")){if(e.parentElement.setValue=function(s){(e=this.querySelector("input"))?(e.value=s,e.onkeyup()):(e=this.querySelector("textarea"))&&(e.value=s,e.onkeyup())},e.parentElement.getValue=function(){if(e=this.querySelector("input")){var e=this.querySelector("input");return e.value}if(e=this.querySelector("textarea")){var e=this.querySelector("input");return e.value}return null},smash.class.has(e.parentElement,"has-floating-label")){smash.class.remove(e.parentElement,"has-floating-label"),smash.class.add(e.parentElement,"floating-label");var t=document.createElement("label");t.innerHTML=e.placeholder,e.parentElement.appendChild(t),e.onkeyup=function(e){var s=this.parentElement.querySelector("label");s&&(""!=this.value?smash.class.add(s,"show"):smash.class.remove(s,"show"))}}e.parentElement.getAttribute("value")&&e.parentElement.setValue(e.parentElement.getAttribute("value")),smash.class.add(e.parentElement,"smash-initialised")}for(var n,r=document.querySelectorAll(".smash-select select"),a=0;a<r.length;a++)if(n=r[a],!smash.class.has(n.parentElement,"smash-initialised")){if(smash.class.has(n.parentElement,"has-floating-label")){smash.class.remove(n.parentElement,"has-floating-label"),smash.class.add(n.parentElement,"floating-label");var t=document.createElement("label");t.innerHTML=n.getAttribute("placeholder"),n.parentElement.appendChild(t)}n.parentElement.setValue=function(e){smash.class.remove(this,"is-focussed");var s=this.querySelector("select"),a=this.querySelector("input"),t=s.value;s.value=e,s.selectedIndex>-1&&(a.value=s.options[s.selectedIndex].text),a.focus(),a.onfocus(),t!=e&&s.onchange&&s.onchange()},n.parentElement.getValue=function(){var e=this.querySelector("select");return e.selectedIndex==-1?null:e.options[e.selectedIndex].value};var e=document.createElement("input");e.type="text",e.placeholder=n.getAttribute("placeholder"),e.setAttribute("readonly","readonly"),n.parentElement.appendChild(e);for(var o=n.querySelectorAll("option"),i=document.createElement("ul"),c=0;c<o.length;c++){var h=o[c];if(h.getAttribute("value")){var l=document.createElement("li");l.setAttribute("value",h.value),l.innerHTML=h.innerHTML,i.appendChild(l),l.onmousedown=function(e){this.parentElement.parentElement.setValue(this.getAttribute("value")),e.stopPropagation(),window.onmousedown=null}}}n.parentElement.appendChild(i),e.onfocus=function(e){var s=this.parentElement.querySelector("label");s&&(""!=this.value?smash.class.add(s,"show"):smash.class.remove(s,"show"))},n.parentElement.onclick=function(){smash.class.add(this,"is-focussed");var e=this;window.onmousedown=function(){console.log("click outside"),window.onmousedown=null,smash.class.remove(e,"is-focussed")}},n.parentElement.getAttribute("value")&&n.parentElement.setValue(n.parentElement.getAttribute("value")),smash.class.add(n.parentElement,"smash-initialised")}smash.input.checkboxInit()},smash.input.checkboxInit=function(){for(var e,s=document.querySelectorAll(".smash-checkbox input"),a=0;a<s.length;a++)if(e=s[a],!smash.class.has(e.parentElement,"smash-initialised")){var t=document.createElement("span");if(t.className="checks",t.innerHTML='<i class="material-icons">check_box_outline_blank</i><i class="material-icons checked">check_box</i>',e.parentElement.appendChild(t),label=e.getAttribute("label")){var n=document.createElement("span");n.className="label",n.innerHTML=label,e.parentElement.appendChild(n)}smash.class.add(e.parentElement,"smash-initialised"),e.checked=smash.class.has(e.parentElement,"checked"),e.parentElement.onclick=function(){smash.class.toggle(this,"checked"),smash.get(this,"input").checked=smash.class.has(this,"checked")},e.parentElement.getValue=function(){return smash.class.has(this,"checked")},e.parentElement.setValue=function(e){smash.class.has(this,"checked")!=e&&this.onclick()}}},smash.router={__parseRouteRegex:/{(.*?)}/gi,__dynamicParts:[],__routes:{static:[],dynamic:[]}},smash.router.add=function(e,s){var a=smash.router.parseRoute(e);return a.regex?(a.callback=s,smash.router.__routes.dynamic[a.depth]||(smash.router.__routes.dynamic[a.depth]=[]),smash.router.__routes.dynamic[a.depth][a.numVars]||(smash.router.__routes.dynamic[a.depth][a.numVars]=[]),void smash.router.__routes.dynamic[a.depth][a.numVars].push(a)):void(smash.router.__routes.static[e]=s)},smash.router.set=function(e){smash.router.displayURL(e),window.dispatchEvent(new Event("popstate"))},smash.router.displayURL=function(e){window.history.pushState("","",e)},smash.router.redirect=function(e){window.location=e},smash.router.handleNotFound=function(e){console.log("route: "+JSON.stringify(e)+" does not exist")},smash.router.run=function(){window.onpopstate=function(e){smash.router.execute()},smash.router.execute()},smash.router.execute=function(){var e=this.getPath();if(this.__routes.static[e.path])return void this.__routes.static[e.path]();var s=e.path.split("/").length-1;if(this.__routes.dynamic[s]){var a,t,n={};for(var r in this.__routes.dynamic[s])for(var o in this.__routes.dynamic[s][r]){var a=this.__routes.dynamic[s][r][o];if(t=e.path.match(a.regex)){for(var i=0;i<a.numVars;i++)n[a.vars[i]]=t[i+1];return void a.callback(n)}}}smash.router.handleNotFound(e)},smash.router.getPath=function(){var e=document.createElement("a");return e.href=window.location,{host:e.hostname,path:e.pathname}},smash.router.parseRoute=function(e){"/"!=e.substring(0,1)&&(e="/"+e),"/"==e.substring(e.length-2)&&(e="/"+e);var s={path:e,depth:e.split("/").length-1,vars:[],numVars:0};if(smash.router.__dynamicParts=e.match(smash.router.__parseRouteRegex),void 0!=smash.router.__dynamicParts&&null!=smash.router.__dynamicParts){for(var a="^"+e.replace(/\//gi,"\\/")+"$",t=0;t<smash.router.__dynamicParts.length;t++)s.numVars++,s.vars.push(smash.router.__dynamicParts[t].substring(1,smash.router.__dynamicParts[t].length-1)),a=a.replace(smash.router.__dynamicParts[t],"(.*?)");s.regex=new RegExp(a,"i")}return s},smash.router.queryParam=function(e){var s="[\\?&]"+e+"=([^&#]*)",a=new RegExp(s),t=a.exec(window.location.search);if(null!=t)return t[1]},smash.searchbox={i_:!1,minAutoCompleteLength:3,onfocus:void 0,onblur:void 0,onvalue:void 0},smash.searchbox.init=function(){if(!smash.searchbox.i_){var e=document.querySelector(".smash-searchbox input");e&&(e.onfocus=function(){0==this.value.length&&smash.searchbox.results('<div class="smash-instruction">Start typing to find results</div>'),smash.class.add(document.querySelector(".smash-header"),"is-focussed"),smash.class.add(document.querySelector(".smash-searchbox .smash-searchbox-results"),"show"),smash.searchbox.onfocus&&smash.searchbox.onfocus()},e.onblur=function(){smash.class.remove(document.querySelector(".smash-header"),"is-focussed"),smash.class.remove(document.querySelector(".smash-searchbox .smash-searchbox-results"),"show"),smash.searchbox.onblur&&smash.searchbox.onblur()},e.onkeyup=function(e){this.value.length<smash.searchbox.minAutoCompleteLength||smash.searchbox.onchange&&smash.searchbox.onchange(this.value)},smash.searchbox.i_=!0)}},smash.searchbox.results=function(e){var s=document.querySelector(".smash-searchbox .smash-searchbox-results");s.innerHTML=e},smash.sidebar={i_:!1},smash.sidebar.init=function(){if(!smash.sidebar.i_){var e=document.querySelector(".smash-sidebar .lock");if(e){e.onclick=function(){smash.sidebar.toggleLock()};var s=document.querySelector(".smash-sidebar");smash.class.add(s,"is-unlocked"),smash.sidebar.i_=!0,smash.config.get("sidebar_lock")&&smash.sidebar.toggleLock()}}},smash.sidebar.toggleLock=function(){smash.sidebar.i_&&(smash.class.toggle(document.querySelector(".smash-sidebar .lock"),"unlock"),smash.class.toggle(document.querySelector(".smash-sidebar"),"is-unlocked"),smash.config.set("sidebar_lock",!smash.class.has(document.querySelector(".smash-sidebar"),"is-unlocked")))},smash.storage={},smash.storage.set=function(e,s){localStorage.setItem(e,JSON.stringify(s))},smash.storage.unset=function(e){localStorage.removeItem(e)},smash.storage.get=function(e){var s=localStorage.getItem(e);if(s)return JSON.parse(s)},smash.storage.clear=function(){localStorage.clear()},smash.workspace={baseTitle:void 0,_ws_:void 0,_hdr_:void 0,_sb_:void 0,_tabs_:[]},smash.workspace.init=function(){smash.workspace._ws_=document.querySelector(".smash-workspace"),smash.workspace._ws_&&(smash.workspace._hdr_=document.querySelector(".smash-header"),smash.workspace._hdr_&&smash.class.add(smash.workspace._ws_,"has-header"),smash.workspace._sb_=document.querySelector(".smash-workspace .smash-sidebar"),smash.workspace._sb_&&smash.class.add(smash.workspace._ws_,"has-sidebar"))},smash.workspace.addTab=function(e,s,a,t){if(!smash.get(document,".smash-tab-pane")){var n=smash.get(document,".smash-panel");if(!n)return void console.log("To add a tab there needs to be a panel");n.innerHTML='<div class="smash-tab-pane"><div class="smash-tabs"></div><div class="smash-panes"></div></div>'}var r=smash.get(document,".smash-tab-pane .smash-tabs"),o=smash.get(document,".smash-tab-pane .smash-panes");if(document.title=smash.workspace.createTitle(s),c=smash.get(r,'.smash-tab[data-id="'+e+'"]')){var i=smash.get(o,'.smash-pane[data-id="'+e+'"]');return i.innerHTML=a,c.dataset.url=t,c.onclick(),{tab:c,pane:i}}smash.hide(o,".smash-pane"),(active=smash.get(r,".smash-tab.active"))&&smash.class.remove(active,"active");var c=document.createElement("div");c.className="smash-tab active",c.dataset.id=e,c.dataset.url=t,c.innerHTML=s+'<i class="material-icons close">close</i>',c.onclick=function(e){(active=smash.get(r,".smash-tab.active"))&&smash.class.remove(active,"active"),smash.class.add(this,"active"),smash.hide(document,".smash-pane"),smash.show(document,'.smash-pane[data-id="'+this.dataset.id+'"]'),this.dataset.url&&"undefined"!=this.dataset.url&&smash.router.displayURL(this.dataset.url),document.title=smash.workspace.createTitle(this.innerHTML)},smash.on(c,".close","onclick",function(e){smash.class.has(this.parentElement,"active")&&(this.parentElement.previousSibling?this.parentElement.previousSibling.onclick():this.parentElement.nextSibling&&this.parentElement.nextSibling.onclick()),(i=smash.get(document,'.smash-pane[data-id="'+this.parentElement.dataset.id+'"]'))&&i.parentElement.removeChild(i),this.parentElement.parentElement.removeChild(this.parentElement),e.stopPropagation()}),r.appendChild(c);var i=document.createElement("div");return i.className="smash-pane",i.dataset.id=e,i.innerHTML=a,o.appendChild(i),{tab:c,pane:i}},smash.workspace.activeTab=function(){var e=smash.get(tabs,".smash-tab.active");if(!e)return null;var s=smash.get(document,'.smash-pane[data-id="'+e.dataset.id+'"]');return s?{tab:e,pane:s}:null},smash.workspace.createTitle=function(e){return e.replace(/<([^>]+?)([^>]*?)>(.*?)<\/\1>/gi,"")+(smash.workspace.baseTitle?" | "+smash.workspace.baseTitle:"")};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNtYXNoLmpzIiwiYWpheC5qcyIsImNsYXNzLmpzIiwiY29uZmlnLmpzIiwiZGlhbG9nLmpzIiwiZXhjZXB0aW9uLmpzIiwiaW5wdXQuanMiLCJyb3V0ZXIuanMiLCJzZWFyY2hib3guanMiLCJzaWRlYmFyLmpzIiwic3RvcmFnZS5qcyIsIndvcmtzcGFjZS5qcyJdLCJuYW1lcyI6WyJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsInNtYXNoIiwiaW5pdCIsImNvbmZpZyIsInNpZGViYXIiLCJzZWFyY2hib3giLCJ3b3Jrc3BhY2UiLCJpbnB1dCIsImdldCIsInBhcmVudCIsInNlbGVjdG9yIiwicXVlcnlTZWxlY3RvciIsImNvbnNvbGUiLCJsb2ciLCJnZXRBbGwiLCJxdWVyeVNlbGVjdG9yQWxsIiwiaGlkZSIsImVsIiwiaSIsImxlbmd0aCIsInN0eWxlIiwiZGlzcGxheSIsInNob3ciLCJvbiIsImV2ZW50IiwiY2FsbGJhY2siLCJlbGVtZW50cyIsImFqYXgiLCJfaGVhZGVyc18iLCJhZGRIZWFkZXIiLCJuYW1lIiwidmFsdWUiLCJyZW1vdmVIZWFkZXIiLCJvbmVycm9yIiwibWVzc2FnZSIsIm9udW5hdXRob3JpemVkIiwiX3hocl8iLCJYTUxIdHRwUmVxdWVzdCIsInhociIsInZlcnNpb25zIiwiQWN0aXZlWE9iamVjdCIsInNlbmQiLCJ1cmwiLCJtZXRob2QiLCJkYXRhIiwicmVzcG9uc2VUeXBlIiwiYXN5bmMiLCJ1bmRlZmluZWQiLCJ4Iiwib25yZWFkeXN0YXRlY2hhbmdlIiwicmVhZHlTdGF0ZSIsInN0YXR1cyIsInJlc3BvbnNlIiwib3BlbiIsInNldFJlcXVlc3RIZWFkZXIiLCJxdWVyeSIsImtleSIsInB1c2giLCJlbmNvZGVVUklDb21wb25lbnQiLCJqb2luIiwicG9zdCIsImRhdGFTdHIiLCJKU09OIiwic3RyaW5naWZ5IiwiY2xhc3MiLCJhZGQiLCJjbGFzc05hbWUiLCJoYXMiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJyZXBsYWNlIiwiaW5kZXhPZiIsInRvZ2dsZSIsIl92YWx1ZXNfIiwiX3NpZGViYXJfbG9ja18iLCJ2Iiwic3RvcmFnZSIsIm9wdGlvbiIsIm8iLCJFeGNlcHRpb24iLCJzZXQiLCJkaWFsb2ciLCJuZXciLCJjb250ZW50IiwiYmFja2Ryb3AiLCJjaGVja0JhY2tkcm9wIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiaW5uZXJIVE1MIiwiYXBwZW5kQ2hpbGQiLCJyZW1vdmVDaGlsZCIsIm9uY2xpY2siLCJjbG9zZSIsInRoaXMiLCJ0b1N0cmluZyIsImlucHV0cyIsInBhcmVudEVsZW1lbnQiLCJzZXRWYWx1ZSIsIm9ua2V5dXAiLCJnZXRWYWx1ZSIsImxhYmVsIiwicGxhY2Vob2xkZXIiLCJsIiwiZ2V0QXR0cmlidXRlIiwic2VsZWN0Iiwic2VsZWN0cyIsIm9sZCIsInNlbGVjdGVkSW5kZXgiLCJvcHRpb25zIiwidGV4dCIsImZvY3VzIiwib25mb2N1cyIsIm9uY2hhbmdlIiwidHlwZSIsInNldEF0dHJpYnV0ZSIsInVsIiwiaiIsImxpIiwib25tb3VzZWRvd24iLCJzdG9wUHJvcGFnYXRpb24iLCJjaGVja2JveEluaXQiLCJjaGVja2JveCIsImNoZWNrYm94ZXMiLCJjIiwiY2hlY2tlZCIsInJvdXRlciIsIl9fcGFyc2VSb3V0ZVJlZ2V4IiwiX19keW5hbWljUGFydHMiLCJfX3JvdXRlcyIsInN0YXRpYyIsImR5bmFtaWMiLCJwYXRoIiwicm91dGUiLCJwYXJzZVJvdXRlIiwicmVnZXgiLCJkZXB0aCIsIm51bVZhcnMiLCJkaXNwbGF5VVJMIiwiZGlzcGF0Y2hFdmVudCIsIkV2ZW50IiwiaGlzdG9yeSIsInB1c2hTdGF0ZSIsInJlZGlyZWN0IiwibG9jYXRpb24iLCJoYW5kbGVOb3RGb3VuZCIsInJ1biIsIm9ucG9wc3RhdGUiLCJleGVjdXRlIiwiZ2V0UGF0aCIsInNwbGl0IiwibWF0Y2hlcyIsInZhck51bSIsIml0ZW0iLCJtYXRjaCIsInZhcnMiLCJocmVmIiwiaG9zdCIsImhvc3RuYW1lIiwicGF0aG5hbWUiLCJzdWJzdHJpbmciLCJSZWdFeHAiLCJxdWVyeVBhcmFtIiwicGFyYW0iLCJyZWdleFMiLCJyZXN1bHRzIiwiZXhlYyIsInNlYXJjaCIsImlfIiwibWluQXV0b0NvbXBsZXRlTGVuZ3RoIiwib25ibHVyIiwib252YWx1ZSIsInNzYiIsInNpYmwiLCJ0b2dnbGVMb2NrIiwic2liIiwibG9jYWxTdG9yYWdlIiwic2V0SXRlbSIsInVuc2V0IiwicmVtb3ZlSXRlbSIsImdldEl0ZW0iLCJwYXJzZSIsImNsZWFyIiwiYmFzZVRpdGxlIiwiX3dzXyIsIl9oZHJfIiwiX3NiXyIsIl90YWJzXyIsImFkZFRhYiIsImlkIiwidGl0bGUiLCJwYW5lbCIsInRhYnMiLCJwYW5lc0NvbnRhaW5lciIsImNyZWF0ZVRpdGxlIiwidGFiIiwicGFuZSIsImRhdGFzZXQiLCJhY3RpdmUiLCJwcmV2aW91c1NpYmxpbmciLCJuZXh0U2libGluZyIsImFjdGl2ZVRhYiJdLCJtYXBwaW5ncyI6IkFBQUFBLE9BQUFDLGlCQUFBLE9BQUEsU0FBQUMsR0FDQUMsTUFBQUMsU0FDQSxFQUVBLElBQUFELFNBRUFBLE9BQUFDLEtBQUEsV0FDQUQsTUFBQUUsT0FBQUQsT0FDQUQsTUFBQUcsUUFBQUYsT0FDQUQsTUFBQUksVUFBQUgsT0FDQUQsTUFBQUssVUFBQUosT0FDQUQsTUFBQU0sTUFBQUwsUUFHQUQsTUFBQU8sSUFBQSxTQUFBQyxFQUFBQyxHQUNBLElBQ0EsTUFBQUQsR0FBQUUsY0FBQUQsR0FDQSxNQUFBVixHQUNBWSxRQUFBQyxJQUFBYixLQUtBQyxNQUFBYSxPQUFBLFNBQUFMLEVBQUFDLEdBQ0EsSUFDQSxNQUFBRCxHQUFBTSxpQkFBQUwsR0FDQSxNQUFBVixHQUNBWSxRQUFBQyxJQUFBYixLQUtBQyxNQUFBZSxLQUFBLFNBQUFQLEVBQUFDLEdBRUEsSUFBQSxHQURBTyxHQUFBaEIsTUFBQWEsT0FBQUwsRUFBQUMsR0FDQVEsRUFBQSxFQUFBQSxFQUFBRCxFQUFBRSxPQUFBRCxJQUNBRCxFQUFBQyxHQUFBRSxN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S0FBQUcsZUFDQWhHLEVBQUF1SCxvQkFFQXdFLEVBQUF0RyxZQUFBeUcsRUFHQSxJQUFBQyxHQUFBN0csU0FBQUMsY0FBQSxNQUtBLE9BSkE0RyxHQUFBakksVUFBQSxhQUNBaUksRUFBQUMsUUFBQVIsR0FBQUEsRUFDQU8sRUFBQTNHLFVBQUFMLEVBQ0E2RyxFQUFBdkcsWUFBQTBHLElBQ0FELElBQUFBLEVBQUFDLEtBQUFBLElBR0FsTSxNQUFBSyxVQUFBa00sVUFBQSxXQUNBLEdBQUFOLEdBQUFqTSxNQUFBTyxJQUFBdUwsS0FBQSxvQkFDQSxLQUFBRyxFQUNBLE1BQUEsS0FFQSxJQUFBQyxHQUFBbE0sTUFBQU8sSUFBQThFLFNBQUEsd0JBQUE0RyxFQUFBRSxRQUFBUixHQUFBLEtBQ0EsT0FBQU8sSUFHQUQsSUFBQUEsRUFBQUMsS0FBQUEsR0FGQSxNQUtBbE0sTUFBQUssVUFBQTJMLFlBQUEsU0FBQUosR0FDQSxNQUFBQSxHQUFBdkgsUUFBQSxrQ0FBQSxLQUFBckUsTUFBQUssVUFBQWdMLFVBQUEsTUFBQXJMLE1BQUFLLFVBQUFnTCxVQUFBIiwiZmlsZSI6InNtYXNoLmpzIiwic291cmNlc0NvbnRlbnQiOlsid2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsIGZ1bmN0aW9uKGUpe1xuICAgIHNtYXNoLmluaXQoKTtcbn0sIGZhbHNlKTtcblxudmFyIHNtYXNoID0ge307XG5cbnNtYXNoLmluaXQgPSBmdW5jdGlvbigpIHtcbiAgICBzbWFzaC5jb25maWcuaW5pdCgpO1xuICAgIHNtYXNoLnNpZGViYXIuaW5pdCgpO1xuICAgIHNtYXNoLnNlYXJjaGJveC5pbml0KCk7XG4gICAgc21hc2gud29ya3NwYWNlLmluaXQoKTtcbiAgICBzbWFzaC5pbnB1dC5pbml0KCk7XG59O1xuXG5zbWFzaC5nZXQgPSBmdW5jdGlvbihwYXJlbnQsIHNlbGVjdG9yKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIHBhcmVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcbiAgICB9IGNhdGNoKGUpIHtcbiAgICAgICAgY29uc29sZS5sb2coZSk7XG4gICAgfVxuICAgIHJldHVybiB1bmRlZmluZWQ7XG59O1xuXG5zbWFzaC5nZXRBbGwgPSBmdW5jdGlvbihwYXJlbnQsIHNlbGVjdG9yKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIHBhcmVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKTtcbiAgICB9IGNhdGNoKGUpIHtcbiAgICAgICAgY29uc29sZS5sb2coZSk7XG4gICAgfVxuICAgIHJldHVybiB1bmRlZmluZWQ7XG59O1xuXG5zbWFzaC5oaWRlID0gZnVuY3Rpb24ocGFyZW50LCBzZWxlY3Rvcikge1xuICAgIHZhciBlbCA9IHNtYXNoLmdldEFsbChwYXJlbnQsIHNlbGVjdG9yKTtcbiAgICBmb3IgKHZhciBpPTA7IGk8ZWwubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZWxbaV0uc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICB9XG59O1xuXG5zbWFzaC5zaG93ID0gZnVuY3Rpb24ocGFyZW50LCBzZWxlY3Rvcikge1xuICAgIHZhciBlbCA9IHNtYXNoLmdldEFsbChwYXJlbnQsIHNlbGVjdG9yKTtcbiAgICBmb3IgKHZhciBpPTA7IGk8ZWwubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZWxbaV0uc3R5bGUuZGlzcGxheSA9ICcnO1xuICAgIH1cbn07XG5cbnNtYXNoLm9uID0gZnVuY3Rpb24ocGFyZW50LCBzZWxlY3RvciwgZXZlbnQsIGNhbGxiYWNrKSB7XG4gICAgdmFyIGVsZW1lbnRzID0gc21hc2guZ2V0QWxsKHBhcmVudCwgc2VsZWN0b3IpO1xuICAgIGZvciAodmFyIGk9MDsgaTxlbGVtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBlbGVtZW50c1tpXVtldmVudF0gPSBjYWxsYmFjaztcbiAgICB9XG59O1xuIiwic21hc2guYWpheCA9IHtcbiAgICBfaGVhZGVyc186IFtdXG59O1xuXG5zbWFzaC5hamF4LmFkZEhlYWRlciA9IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7XG4gICAgc21hc2guYWpheC5faGVhZGVyc19bbmFtZV0gPSB2YWx1ZTtcbn07XG5cbnNtYXNoLmFqYXgucmVtb3ZlSGVhZGVyID0gZnVuY3Rpb24obmFtZSkge1xuICAgIGRlbGV0ZSBzbWFzaC5hamF4Ll9oZWFkZXJzX1tuYW1lXTtcbn07XG5cbnNtYXNoLmFqYXgub25lcnJvciA9IGZ1bmN0aW9uKG1lc3NhZ2UpIHtcbiAgICBjb25zb2xlLmxvZyhtZXNzYWdlKTtcbn07XG5cbnNtYXNoLmFqYXgub251bmF1dGhvcml6ZWQgPSBmdW5jdGlvbihtZXNzYWdlKSB7XG4gICAgc21hc2guYWpheC5vbmVycm9yKG1lc3NhZ2UpO1xufTtcblxuc21hc2guYWpheC5feGhyXyA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAodHlwZW9mIFhNTEh0dHBSZXF1ZXN0ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICByZXR1cm4gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgfVxuICAgIHZhciB2ZXJzaW9ucyA9IFtcbiAgICAgICAgXCJNU1hNTDIuWG1sSHR0cC42LjBcIixcbiAgICAgICAgXCJNU1hNTDIuWG1sSHR0cC41LjBcIixcbiAgICAgICAgXCJNU1hNTDIuWG1sSHR0cC40LjBcIixcbiAgICAgICAgXCJNU1hNTDIuWG1sSHR0cC4zLjBcIixcbiAgICAgICAgXCJNU1hNTDIuWG1sSHR0cC4yLjBcIixcbiAgICAgICAgXCJNaWNyb3NvZnQuWG1sSHR0cFwiXG4gICAgXTtcbiAgICB2YXIgeGhyO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmVyc2lvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHhociA9IG5ldyBBY3RpdmVYT2JqZWN0KHZlcnNpb25zW2ldKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHhocjtcbn07XG5cbnNtYXNoLmFqYXguc2VuZCA9IGZ1bmN0aW9uICh1cmwsIGNhbGxiYWNrLCBtZXRob2QsIGRhdGEsIHJlc3BvbnNlVHlwZSwgYXN5bmMpIHtcbiAgICBpZiAoYXN5bmMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBhc3luYyA9IHRydWU7XG4gICAgfVxuICAgIHZhciB4ID0gc21hc2guYWpheC5feGhyXygpO1xuICAgIHgucmVzcG9uc2VUeXBlID0gcmVzcG9uc2VUeXBlO1xuICAgIHgub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkge1xuXHRcdGlmICh4LnJlYWR5U3RhdGUgPT0gNCkge1xuICAgICAgICAgICAgc3dpdGNoICh4LnN0YXR1cykge1xuICAgICAgICAgICAgY2FzZSAyMDA6XG4gICAgICAgICAgICBjYXNlIDIwMTpcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soeC5yZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSA0MDE6XG4gICAgICAgICAgICAgICAgc21hc2guYWpheC5vbnVuYXV0aG9yaXplZCh4LnJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgc21hc2guYWpheC5vbmVycm9yKHgucmVzcG9uc2UpO1xuICAgICAgICAgICAgfVxuXHRcdH1cbiAgICB9O1xuICAgIHgub3BlbihtZXRob2QsIHVybCwgYXN5bmMpO1xuICAgIGlmIChyZXNwb25zZVR5cGUgPT0gJ2pzb24nKSB7XG4gICAgICAgIHguc2V0UmVxdWVzdEhlYWRlcignQ29udGVudC10eXBlJywgJ2FwcGxpY2F0aW9uL2pzb24nKTtcbiAgICB9IGVsc2UgaWYgKG1ldGhvZCA9PSAnUE9TVCcpIHtcbiAgICAgICAgeC5zZXRSZXF1ZXN0SGVhZGVyKCdDb250ZW50LXR5cGUnLCAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJyk7XG4gICAgfVxuICAgIGZvciAodmFyIG5hbWUgaW4gc21hc2guYWpheC5faGVhZGVyc18pIHtcbiAgICAgICAgeC5zZXRSZXF1ZXN0SGVhZGVyKG5hbWUsIHNtYXNoLmFqYXguX2hlYWRlcnNfW25hbWVdKTtcbiAgICB9XG4gICAgeC5zZW5kKGRhdGEpXG59O1xuXG5zbWFzaC5hamF4LmdldCA9IGZ1bmN0aW9uICh1cmwsIGNhbGxiYWNrLCBkYXRhLCByZXNwb25zZVR5cGUsIGFzeW5jKSB7XG4gICAgdmFyIHF1ZXJ5ID0gW107XG4gICAgZm9yICh2YXIga2V5IGluIGRhdGEpIHtcbiAgICAgICAgcXVlcnkucHVzaChlbmNvZGVVUklDb21wb25lbnQoa2V5KSArICc9JyArIGVuY29kZVVSSUNvbXBvbmVudChkYXRhW2tleV0pKTtcbiAgICB9XG4gICAgc21hc2guYWpheC5zZW5kKHVybCArIChxdWVyeS5sZW5ndGggPyAnPycgKyBxdWVyeS5qb2luKCcmJykgOiAnJyksIGNhbGxiYWNrLCAnR0VUJywgbnVsbCwgcmVzcG9uc2VUeXBlLCAgYXN5bmMpXG59O1xuXG5zbWFzaC5hamF4LnBvc3QgPSBmdW5jdGlvbiAodXJsLCBjYWxsYmFjaywgZGF0YSwgcmVzcG9uc2VUeXBlLCBhc3luYykge1xuICAgIHZhciBkYXRhU3RyO1xuICAgIGlmIChkYXRhKSB7XG4gICAgICAgIGlmIChyZXNwb25zZVR5cGUgIT0gJ2pzb24nKSB7XG4gICAgICAgICAgICB2YXIgcXVlcnkgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBkYXRhKSB7XG4gICAgICAgICAgICAgICAgcXVlcnkucHVzaChlbmNvZGVVUklDb21wb25lbnQoa2V5KSArICc9JyArIGVuY29kZVVSSUNvbXBvbmVudChkYXRhW2tleV0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRhdGFTdHIgPSBxdWVyeS5qb2luKCcmJylcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGRhdGFTdHIgPSBKU09OLnN0cmluZ2lmeShkYXRhKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzbWFzaC5hamF4LnNlbmQodXJsLCBjYWxsYmFjaywgJ1BPU1QnLCBkYXRhU3RyLCByZXNwb25zZVR5cGUsIGFzeW5jKVxufTtcbiIsInNtYXNoLmNsYXNzID0ge307XG5cbnNtYXNoLmNsYXNzLmFkZCA9IGZ1bmN0aW9uKGVsLCBjbGFzc05hbWUpIHtcbiAgICBpZiAoIXNtYXNoLmNsYXNzLmhhcyhlbCwgY2xhc3NOYW1lKSkge1xuICAgICAgICBlbC5jbGFzc0xpc3QgPyBlbC5jbGFzc0xpc3QuYWRkKGNsYXNzTmFtZSkgOiBlbC5jbGFzc05hbWUgKz0gKCcgJyArIGNsYXNzTmFtZSk7XG4gICAgfVxufTtcblxuc21hc2guY2xhc3MucmVtb3ZlID0gZnVuY3Rpb24oZWwsIGNsYXNzTmFtZSkge1xuICAgIGlmIChzbWFzaC5jbGFzcy5oYXMoZWwsIGNsYXNzTmFtZSkpIHtcbiAgICAgICAgZWwuY2xhc3NMaXN0ID8gZWwuY2xhc3NMaXN0LnJlbW92ZShjbGFzc05hbWUpIDogZWwuY2xhc3NOYW1lID0gZWwuY2xhc3NOYW1lLnJlcGxhY2UoY2xhc3NOYW1lLCAnJyk7XG4gICAgfVxufTtcblxuc21hc2guY2xhc3MuaGFzID0gZnVuY3Rpb24oZWwsIGNsYXNzTmFtZSkge1xuICAgIHJldHVybiAoKFwiIFwiICsgZWwuY2xhc3NOYW1lICsgXCIgXCIpLnJlcGxhY2UoL1tcXG5cXHRdL2csIFwiIFwiKS5pbmRleE9mKFwiIFwiICsgY2xhc3NOYW1lICsgXCIgXCIpID4gLTEpO1xufTtcblxuc21hc2guY2xhc3MudG9nZ2xlID0gZnVuY3Rpb24oZWwsIGNsYXNzTmFtZSkge1xuICAgIHNtYXNoLmNsYXNzLmhhcyhlbCwgY2xhc3NOYW1lKSA/IHNtYXNoLmNsYXNzLnJlbW92ZShlbCwgY2xhc3NOYW1lKSA6IHNtYXNoLmNsYXNzLmFkZChlbCwgY2xhc3NOYW1lKTtcbn07XG4iLCJzbWFzaC5jb25maWcgPSB7XG4gICAgX3ZhbHVlc186IHtcbiAgICAgICAgX3NpZGViYXJfbG9ja186IGZhbHNlXG4gICAgfVxufVxuXG5zbWFzaC5jb25maWcuaW5pdCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciB2ID0gc21hc2guc3RvcmFnZS5nZXQoJ2NvbmZpZycpO1xuICAgIGlmICh2KSB7XG4gICAgICAgIHNtYXNoLmNvbmZpZy5fdmFsdWVzXyA9IHY7XG4gICAgfVxufTtcblxuc21hc2guY29uZmlnLmdldCA9IGZ1bmN0aW9uKG9wdGlvbikge1xuICAgIHZhciBvID0gJ18nICsgb3B0aW9uICsgJ18nO1xuICAgIGlmIChvIGluIHNtYXNoLmNvbmZpZy5fdmFsdWVzXykge1xuICAgICAgICByZXR1cm4gc21hc2guY29uZmlnLl92YWx1ZXNfW29dO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgc21hc2guRXhjZXB0aW9uKCcwMDEnLCAnSW52YWxpZCBjb25maWcgb3B0aW9uIFwiJyArIG9wdGlvbiArICdcIicpO1xufTtcblxuc21hc2guY29uZmlnLnNldCA9IGZ1bmN0aW9uKG9wdGlvbiwgdmFsdWUpIHtcbiAgICB2YXIgbyA9ICdfJyArIG9wdGlvbiArICdfJztcbiAgICBpZiAoIW8gaW4gc21hc2guY29uZmlnLl92YWx1ZXNfKSB7XG4gICAgICAgIHRocm93IG5ldyBzbWFzaC5FeGNlcHRpb24oJzAwMScsICdJbnZhbGlkIGNvbmZpZyBvcHRpb24gXCInICsgb3B0aW9uICsgJ1wiJyk7XG4gICAgfVxuICAgIHNtYXNoLmNvbmZpZy5fdmFsdWVzX1tvXSA9IHZhbHVlO1xuICAgIHNtYXNoLnN0b3JhZ2Uuc2V0KCdjb25maWcnLCBzbWFzaC5jb25maWcuX3ZhbHVlc18pO1xufTtcbiIsInNtYXNoLmRpYWxvZyA9IHt9O1xuXG5zbWFzaC5kaWFsb2cubmV3ID0gZnVuY3Rpb24oY29udGVudCkge1xuICAgIHZhciBiYWNrZHJvcCA9IHNtYXNoLmRpYWxvZy5jaGVja0JhY2tkcm9wKCk7XG5cbiAgICB2YXIgZGlhbG9nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgZGlhbG9nLmNsYXNzTmFtZSA9ICdzbWFzaC1kaWFsb2cnO1xuICAgIGRpYWxvZy5pbm5lckhUTUwgPSBjb250ZW50O1xuICAgIGJhY2tkcm9wLmFwcGVuZENoaWxkKGRpYWxvZyk7XG59O1xuXG5zbWFzaC5kaWFsb2cuY2hlY2tCYWNrZHJvcCA9IGZ1bmN0aW9uKCkge1xuICAgIGlmIChiYWNrZHJvcCA9IHNtYXNoLmdldChkb2N1bWVudCwgXCIuc21hc2gtZGlhbG9nLWJhY2tkcm9wXCIpKSB7XG4gICAgICAgIGlmIChkaWFsb2cgPSBzbWFzaC5nZXQoZG9jdW1lbnQsIFwiLnNtYXNoLWRpYWxvZy1iYWNrZHJvcCAuc21hc2gtZGlhbG9nXCIpKSB7XG4gICAgICAgICAgICBiYWNrZHJvcC5yZW1vdmVDaGlsZChkaWFsb2cpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBiYWNrZHJvcDtcbiAgICB9XG4gICAgdmFyIGJhY2tkcm9wID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgYmFja2Ryb3AuY2xhc3NOYW1lID0gJ3NtYXNoLWRpYWxvZy1iYWNrZHJvcCc7XG4gICAgYmFja2Ryb3AuaW5uZXJIVE1MID0gJzxkaXYgY2xhc3M9XCJzbWFzaC1kaWFsb2ctYmFja2dyb3VuZFwiPjwvZGl2Pic7XG4gICAgc21hc2guZ2V0KGJhY2tkcm9wLCAnLnNtYXNoLWRpYWxvZy1iYWNrZ3JvdW5kJykub25jbGljayA9IHNtYXNoLmRpYWxvZy5jbG9zZTtcbiAgICBzbWFzaC5nZXQoZG9jdW1lbnQsICdib2R5JykuYXBwZW5kQ2hpbGQoYmFja2Ryb3ApO1xuICAgIHJldHVybiBiYWNrZHJvcDtcbn07XG5cbnNtYXNoLmRpYWxvZy5jbG9zZSA9IGZ1bmN0aW9uKCkge1xuICAgIGlmIChkaWFsb2cgPSBzbWFzaC5nZXQoZG9jdW1lbnQsIFwiLnNtYXNoLWRpYWxvZy1iYWNrZHJvcFwiKSkge1xuICAgICAgICBzbWFzaC5nZXQoZG9jdW1lbnQsICdib2R5JykucmVtb3ZlQ2hpbGQoZGlhbG9nKTtcbiAgICB9XG59O1xuIiwic21hc2guRXhjZXB0aW9uID0gZnVuY3Rpb24gKHZhbHVlLCBtZXNzYWdlKSB7XG4gICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2U7XG4gICAgdGhpcy50b1N0cmluZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gJ1NtYXNoRXhjZXB0aW9uICcgKyB0aGlzLnZhbHVlICsgJzogJyArIHRoaXMubWVzc2FnZTtcbiAgICB9O1xufTtcbiIsInNtYXNoLmlucHV0ID0ge307XG5cbnNtYXNoLmlucHV0LmluaXQgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgaW5wdXRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5zbWFzaC1pbnB1dCBpbnB1dCwgLnNtYXNoLXRleHRhcmVhIHRleHRhcmVhXCIpO1xuICAgIHZhciBpbnB1dDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGlucHV0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpbnB1dCA9IGlucHV0c1tpXTtcbiAgICAgICAgaWYgKHNtYXNoLmNsYXNzLmhhcyhpbnB1dC5wYXJlbnRFbGVtZW50LCAnc21hc2gtaW5pdGlhbGlzZWQnKSkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cblxuICAgICAgICBpbnB1dC5wYXJlbnRFbGVtZW50LnNldFZhbHVlID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgIGlmIChpbnB1dCA9IHRoaXMucXVlcnlTZWxlY3RvcihcImlucHV0XCIpKSB7XG4gICAgICAgICAgICAgICAgaW5wdXQudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBpbnB1dC5vbmtleXVwKCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGlucHV0ID0gdGhpcy5xdWVyeVNlbGVjdG9yKFwidGV4dGFyZWFcIikpIHtcbiAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGlucHV0Lm9ua2V5dXAoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBpbnB1dC5wYXJlbnRFbGVtZW50LmdldFZhbHVlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoaW5wdXQgPSB0aGlzLnF1ZXJ5U2VsZWN0b3IoXCJpbnB1dFwiKSkge1xuICAgICAgICAgICAgICAgIHZhciBpbnB1dCA9IHRoaXMucXVlcnlTZWxlY3RvcihcImlucHV0XCIpO1xuICAgICAgICAgICAgICAgIHJldHVybiBpbnB1dC52YWx1ZVxuICAgICAgICAgICAgfSBlbHNlIGlmIChpbnB1dCA9IHRoaXMucXVlcnlTZWxlY3RvcihcInRleHRhcmVhXCIpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGlucHV0ID0gdGhpcy5xdWVyeVNlbGVjdG9yKFwiaW5wdXRcIik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGlucHV0LnZhbHVlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAoc21hc2guY2xhc3MuaGFzKGlucHV0LnBhcmVudEVsZW1lbnQsICdoYXMtZmxvYXRpbmctbGFiZWwnKSkge1xuICAgICAgICAgICAgc21hc2guY2xhc3MucmVtb3ZlKGlucHV0LnBhcmVudEVsZW1lbnQsICdoYXMtZmxvYXRpbmctbGFiZWwnKTtcbiAgICAgICAgICAgIHNtYXNoLmNsYXNzLmFkZChpbnB1dC5wYXJlbnRFbGVtZW50LCAnZmxvYXRpbmctbGFiZWwnKTtcblxuICAgICAgICAgICAgdmFyIGxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKTtcbiAgICAgICAgICAgIGxhYmVsLmlubmVySFRNTCA9IGlucHV0LnBsYWNlaG9sZGVyO1xuICAgICAgICAgICAgaW5wdXQucGFyZW50RWxlbWVudC5hcHBlbmRDaGlsZChsYWJlbCk7XG4gICAgICAgICAgICBpbnB1dC5vbmtleXVwID0gZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgICAgIHZhciBsID0gdGhpcy5wYXJlbnRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJsYWJlbFwiKTtcbiAgICAgICAgICAgICAgICBpZiAobCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy52YWx1ZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzbWFzaC5jbGFzcy5hZGQobCwgJ3Nob3cnKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNtYXNoLmNsYXNzLnJlbW92ZShsLCAnc2hvdycpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChpbnB1dC5wYXJlbnRFbGVtZW50LmdldEF0dHJpYnV0ZSgndmFsdWUnKSkge1xuICAgICAgICAgICAgaW5wdXQucGFyZW50RWxlbWVudC5zZXRWYWx1ZShpbnB1dC5wYXJlbnRFbGVtZW50LmdldEF0dHJpYnV0ZSgndmFsdWUnKSk7XG4gICAgICAgIH1cblxuICAgICAgICBzbWFzaC5jbGFzcy5hZGQoaW5wdXQucGFyZW50RWxlbWVudCwgJ3NtYXNoLWluaXRpYWxpc2VkJyk7XG4gICAgfVxuICAgIHZhciBzZWxlY3RzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5zbWFzaC1zZWxlY3Qgc2VsZWN0XCIpO1xuICAgIHZhciBzZWxlY3Q7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxlY3RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHNlbGVjdCA9IHNlbGVjdHNbaV07XG4gICAgICAgIGlmIChzbWFzaC5jbGFzcy5oYXMoc2VsZWN0LnBhcmVudEVsZW1lbnQsICdzbWFzaC1pbml0aWFsaXNlZCcpKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc21hc2guY2xhc3MuaGFzKHNlbGVjdC5wYXJlbnRFbGVtZW50LCAnaGFzLWZsb2F0aW5nLWxhYmVsJykpIHtcbiAgICAgICAgICAgIHNtYXNoLmNsYXNzLnJlbW92ZShzZWxlY3QucGFyZW50RWxlbWVudCwgJ2hhcy1mbG9hdGluZy1sYWJlbCcpO1xuICAgICAgICAgICAgc21hc2guY2xhc3MuYWRkKHNlbGVjdC5wYXJlbnRFbGVtZW50LCAnZmxvYXRpbmctbGFiZWwnKTtcbiAgICAgICAgICAgIHZhciBsYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJyk7XG4gICAgICAgICAgICBsYWJlbC5pbm5lckhUTUwgPSBzZWxlY3QuZ2V0QXR0cmlidXRlKCdwbGFjZWhvbGRlcicpO1xuICAgICAgICAgICAgc2VsZWN0LnBhcmVudEVsZW1lbnQuYXBwZW5kQ2hpbGQobGFiZWwpO1xuICAgICAgICB9XG5cbiAgICAgICAgc2VsZWN0LnBhcmVudEVsZW1lbnQuc2V0VmFsdWUgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgICAgc21hc2guY2xhc3MucmVtb3ZlKHRoaXMsICdpcy1mb2N1c3NlZCcpO1xuICAgICAgICAgICAgdmFyIHNlbGVjdCA9IHRoaXMucXVlcnlTZWxlY3RvcihcInNlbGVjdFwiKTtcbiAgICAgICAgICAgIHZhciBpbnB1dCA9IHRoaXMucXVlcnlTZWxlY3RvcihcImlucHV0XCIpO1xuICAgICAgICAgICAgdmFyIG9sZCA9IHNlbGVjdC52YWx1ZTtcbiAgICAgICAgICAgIHNlbGVjdC52YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgaWYgKHNlbGVjdC5zZWxlY3RlZEluZGV4ID4gLTEpIHtcbiAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZSA9IHNlbGVjdC5vcHRpb25zW3NlbGVjdC5zZWxlY3RlZEluZGV4XS50ZXh0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaW5wdXQuZm9jdXMoKTtcbiAgICAgICAgICAgIGlucHV0Lm9uZm9jdXMoKTtcbiAgICAgICAgICAgIGlmIChvbGQgIT0gdmFsdWUgJiYgc2VsZWN0Lm9uY2hhbmdlKSB7XG4gICAgICAgICAgICAgICAgc2VsZWN0Lm9uY2hhbmdlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgc2VsZWN0LnBhcmVudEVsZW1lbnQuZ2V0VmFsdWUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBzZWxlY3QgPSB0aGlzLnF1ZXJ5U2VsZWN0b3IoXCJzZWxlY3RcIik7XG4gICAgICAgICAgICBpZiAoc2VsZWN0LnNlbGVjdGVkSW5kZXggPT0gLTEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBzZWxlY3Qub3B0aW9uc1tzZWxlY3Quc2VsZWN0ZWRJbmRleF0udmFsdWU7XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgICAgICAgaW5wdXQudHlwZSA9IFwidGV4dFwiO1xuICAgICAgICBpbnB1dC5wbGFjZWhvbGRlciA9IHNlbGVjdC5nZXRBdHRyaWJ1dGUoJ3BsYWNlaG9sZGVyJyk7XG4gICAgICAgIGlucHV0LnNldEF0dHJpYnV0ZShcInJlYWRvbmx5XCIsIFwicmVhZG9ubHlcIik7XG4gICAgICAgIHNlbGVjdC5wYXJlbnRFbGVtZW50LmFwcGVuZENoaWxkKGlucHV0KTtcblxuICAgICAgICB2YXIgb3B0aW9ucyA9IHNlbGVjdC5xdWVyeVNlbGVjdG9yQWxsKFwib3B0aW9uXCIpO1xuICAgICAgICB2YXIgdWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd1bCcpO1xuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG9wdGlvbnMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgIHZhciBvcHRpb24gPSBvcHRpb25zW2pdO1xuICAgICAgICAgICAgaWYgKCFvcHRpb24uZ2V0QXR0cmlidXRlKCd2YWx1ZScpKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xuICAgICAgICAgICAgbGkuc2V0QXR0cmlidXRlKFwidmFsdWVcIiwgb3B0aW9uLnZhbHVlKTtcbiAgICAgICAgICAgIGxpLmlubmVySFRNTCA9IG9wdGlvbi5pbm5lckhUTUw7XG4gICAgICAgICAgICB1bC5hcHBlbmRDaGlsZChsaSk7XG4gICAgICAgICAgICBsaS5vbm1vdXNlZG93biA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudC5zZXRWYWx1ZSh0aGlzLmdldEF0dHJpYnV0ZSgndmFsdWUnKSk7XG4gICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICB3aW5kb3cub25tb3VzZWRvd24gPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHNlbGVjdC5wYXJlbnRFbGVtZW50LmFwcGVuZENoaWxkKHVsKTtcbiAgICAgICAgaW5wdXQub25mb2N1cyA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIHZhciBsID0gdGhpcy5wYXJlbnRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJsYWJlbFwiKTtcbiAgICAgICAgICAgIGlmIChsKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudmFsdWUgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICBzbWFzaC5jbGFzcy5hZGQobCwgJ3Nob3cnKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzbWFzaC5jbGFzcy5yZW1vdmUobCwgJ3Nob3cnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHNlbGVjdC5wYXJlbnRFbGVtZW50Lm9uY2xpY2sgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHNtYXNoLmNsYXNzLmFkZCh0aGlzLCAnaXMtZm9jdXNzZWQnKTtcbiAgICAgICAgICAgIHZhciBzZWxlY3QgPSB0aGlzO1xuICAgICAgICAgICAgd2luZG93Lm9ubW91c2Vkb3duID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJjbGljayBvdXRzaWRlXCIpO1xuICAgICAgICAgICAgICAgIHdpbmRvdy5vbm1vdXNlZG93biA9IG51bGw7XG4gICAgICAgICAgICAgICAgc21hc2guY2xhc3MucmVtb3ZlKHNlbGVjdCwgJ2lzLWZvY3Vzc2VkJyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChzZWxlY3QucGFyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJykpIHtcbiAgICAgICAgICAgIHNlbGVjdC5wYXJlbnRFbGVtZW50LnNldFZhbHVlKHNlbGVjdC5wYXJlbnRFbGVtZW50LmdldEF0dHJpYnV0ZSgndmFsdWUnKSk7XG4gICAgICAgIH1cbiAgICAgICAgc21hc2guY2xhc3MuYWRkKHNlbGVjdC5wYXJlbnRFbGVtZW50LCAnc21hc2gtaW5pdGlhbGlzZWQnKTtcbiAgICB9XG4gICAgc21hc2guaW5wdXQuY2hlY2tib3hJbml0KCk7XG59O1xuXG5zbWFzaC5pbnB1dC5jaGVja2JveEluaXQgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgY2hlY2tib3hlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc21hc2gtY2hlY2tib3ggaW5wdXRcIik7XG4gICAgdmFyIGNoZWNrYm94O1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hlY2tib3hlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjaGVja2JveCA9IGNoZWNrYm94ZXNbaV07XG4gICAgICAgIGlmIChzbWFzaC5jbGFzcy5oYXMoY2hlY2tib3gucGFyZW50RWxlbWVudCwgJ3NtYXNoLWluaXRpYWxpc2VkJykpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGMgPSAgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgICBjLmNsYXNzTmFtZSA9ICdjaGVja3MnO1xuICAgICAgICBjLmlubmVySFRNTCA9ICc8aSBjbGFzcz1cIm1hdGVyaWFsLWljb25zXCI+Y2hlY2tfYm94X291dGxpbmVfYmxhbms8L2k+PGkgY2xhc3M9XCJtYXRlcmlhbC1pY29ucyBjaGVja2VkXCI+Y2hlY2tfYm94PC9pPic7XG4gICAgICAgIGNoZWNrYm94LnBhcmVudEVsZW1lbnQuYXBwZW5kQ2hpbGQoYyk7XG5cbiAgICAgICAgaWYgKGxhYmVsID0gY2hlY2tib3guZ2V0QXR0cmlidXRlKCdsYWJlbCcpKSB7XG4gICAgICAgICAgICB2YXIgbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgICAgICAgIGwuY2xhc3NOYW1lID0gJ2xhYmVsJztcbiAgICAgICAgICAgIGwuaW5uZXJIVE1MID0gbGFiZWw7XG4gICAgICAgICAgICBjaGVja2JveC5wYXJlbnRFbGVtZW50LmFwcGVuZENoaWxkKGwpO1xuICAgICAgICB9XG4gICAgICAgIHNtYXNoLmNsYXNzLmFkZChjaGVja2JveC5wYXJlbnRFbGVtZW50LCAnc21hc2gtaW5pdGlhbGlzZWQnKTtcbiAgICAgICAgY2hlY2tib3guY2hlY2tlZCA9IHNtYXNoLmNsYXNzLmhhcyhjaGVja2JveC5wYXJlbnRFbGVtZW50LCAnY2hlY2tlZCcpO1xuXG4gICAgICAgIGNoZWNrYm94LnBhcmVudEVsZW1lbnQub25jbGljayA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgc21hc2guY2xhc3MudG9nZ2xlKHRoaXMsICdjaGVja2VkJyk7XG4gICAgICAgICAgICBzbWFzaC5nZXQodGhpcywgJ2lucHV0JykuY2hlY2tlZCA9IHNtYXNoLmNsYXNzLmhhcyh0aGlzLCAnY2hlY2tlZCcpO1xuICAgICAgICB9O1xuXG4gICAgICAgIGNoZWNrYm94LnBhcmVudEVsZW1lbnQuZ2V0VmFsdWUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBzbWFzaC5jbGFzcy5oYXModGhpcywgJ2NoZWNrZWQnKTtcbiAgICAgICAgfTtcblxuICAgICAgICBjaGVja2JveC5wYXJlbnRFbGVtZW50LnNldFZhbHVlID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgIGlmIChzbWFzaC5jbGFzcy5oYXModGhpcywgJ2NoZWNrZWQnKSA9PSB2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMub25jbGljaygpO1xuICAgICAgICB9O1xuICAgIH1cbn07XG4iLCJzbWFzaC5yb3V0ZXIgPSB7XG4gICAgX19wYXJzZVJvdXRlUmVnZXg6IC97KC4qPyl9L2lnLFxuICAgIF9fZHluYW1pY1BhcnRzOiBbXSxcbiAgICBfX3JvdXRlczoge1xuICAgICAgICBzdGF0aWM6IFtdLFxuICAgICAgICBkeW5hbWljOiBbXVxuICAgIH1cbn07XG5cbnNtYXNoLnJvdXRlci5hZGQgPSBmdW5jdGlvbihwYXRoLCBjYWxsYmFjaykge1xuICAgIHZhciByb3V0ZSA9IHNtYXNoLnJvdXRlci5wYXJzZVJvdXRlKHBhdGgpO1xuICAgIGlmIChyb3V0ZS5yZWdleCkge1xuICAgICAgICByb3V0ZS5jYWxsYmFjayA9IGNhbGxiYWNrO1xuICAgICAgICBpZiAoIXNtYXNoLnJvdXRlci5fX3JvdXRlcy5keW5hbWljW3JvdXRlLmRlcHRoXSkge1xuICAgICAgICAgICAgc21hc2gucm91dGVyLl9fcm91dGVzLmR5bmFtaWNbcm91dGUuZGVwdGhdID0gW107XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFzbWFzaC5yb3V0ZXIuX19yb3V0ZXMuZHluYW1pY1tyb3V0ZS5kZXB0aF1bcm91dGUubnVtVmFyc10pIHtcbiAgICAgICAgICAgIHNtYXNoLnJvdXRlci5fX3JvdXRlcy5keW5hbWljW3JvdXRlLmRlcHRoXVtyb3V0ZS5udW1WYXJzXSA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIHNtYXNoLnJvdXRlci5fX3JvdXRlcy5keW5hbWljW3JvdXRlLmRlcHRoXVtyb3V0ZS5udW1WYXJzXS5wdXNoKHJvdXRlKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBzbWFzaC5yb3V0ZXIuX19yb3V0ZXMuc3RhdGljW3BhdGhdID0gY2FsbGJhY2s7XG59O1xuXG5zbWFzaC5yb3V0ZXIuc2V0ID0gZnVuY3Rpb24ocm91dGUpIHtcbiAgICBzbWFzaC5yb3V0ZXIuZGlzcGxheVVSTChyb3V0ZSk7XG4gICAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdwb3BzdGF0ZScpKTtcbn07XG5cbnNtYXNoLnJvdXRlci5kaXNwbGF5VVJMID0gZnVuY3Rpb24ocm91dGUpIHtcbiAgICB3aW5kb3cuaGlzdG9yeS5wdXNoU3RhdGUoXCJcIiwgXCJcIiwgcm91dGUpO1xufTtcblxuc21hc2gucm91dGVyLnJlZGlyZWN0ID0gZnVuY3Rpb24ocm91dGUpIHtcbiAgICB3aW5kb3cubG9jYXRpb24gPSByb3V0ZTtcbn07XG5cbnNtYXNoLnJvdXRlci5oYW5kbGVOb3RGb3VuZCA9IGZ1bmN0aW9uKHJvdXRlKSB7XG4gICAgY29uc29sZS5sb2coXCJyb3V0ZTogXCIgKyBKU09OLnN0cmluZ2lmeShyb3V0ZSkgKyBcIiBkb2VzIG5vdCBleGlzdFwiKTtcbn07XG5cbnNtYXNoLnJvdXRlci5ydW4gPSBmdW5jdGlvbigpIHtcbiAgICB3aW5kb3cub25wb3BzdGF0ZSA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgIHNtYXNoLnJvdXRlci5leGVjdXRlKCk7XG4gICAgfTtcbiAgICBzbWFzaC5yb3V0ZXIuZXhlY3V0ZSgpO1xufVxuXG5zbWFzaC5yb3V0ZXIuZXhlY3V0ZSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBwYXRoID0gdGhpcy5nZXRQYXRoKCk7XG4gICAgaWYgKHRoaXMuX19yb3V0ZXMuc3RhdGljW3BhdGgucGF0aF0pIHtcbiAgICAgICAgdGhpcy5fX3JvdXRlcy5zdGF0aWNbcGF0aC5wYXRoXSgpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBkZXB0aCA9IHBhdGgucGF0aC5zcGxpdChcIi9cIikubGVuZ3RoLTE7XG4gICAgaWYgKHRoaXMuX19yb3V0ZXMuZHluYW1pY1tkZXB0aF0pIHtcbiAgICAgICAgdmFyIHJvdXRlO1xuICAgICAgICB2YXIgbWF0Y2hlcztcbiAgICAgICAgdmFyIGRhdGEgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgdmFyTnVtIGluIHRoaXMuX19yb3V0ZXMuZHluYW1pY1tkZXB0aF0pIHtcbiAgICAgICAgICAgIGZvciAodmFyIGl0ZW0gaW4gdGhpcy5fX3JvdXRlcy5keW5hbWljW2RlcHRoXVt2YXJOdW1dKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJvdXRlID0gdGhpcy5fX3JvdXRlcy5keW5hbWljW2RlcHRoXVt2YXJOdW1dW2l0ZW1dO1xuICAgICAgICAgICAgICAgIG1hdGNoZXMgPSBwYXRoLnBhdGgubWF0Y2gocm91dGUucmVnZXgpO1xuICAgICAgICAgICAgICAgIGlmICghbWF0Y2hlcykge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaT0wOyBpPHJvdXRlLm51bVZhcnM7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBkYXRhW3JvdXRlLnZhcnNbaV1dID0gbWF0Y2hlc1tpKzFdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByb3V0ZS5jYWxsYmFjayhkYXRhKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgc21hc2gucm91dGVyLmhhbmRsZU5vdEZvdW5kKHBhdGgpO1xufTtcblxuc21hc2gucm91dGVyLmdldFBhdGggPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJhXCIpO1xuICAgIGwuaHJlZiA9IHdpbmRvdy5sb2NhdGlvbjtcbiAgICByZXR1cm4ge2hvc3Q6IGwuaG9zdG5hbWUsIHBhdGg6IGwucGF0aG5hbWV9O1xufTtcblxuc21hc2gucm91dGVyLnBhcnNlUm91dGUgPSBmdW5jdGlvbihwYXRoKSB7XG4gICAgaWYgKHBhdGguc3Vic3RyaW5nKDAsMSkgIT0gXCIvXCIpIHtcbiAgICAgICAgcGF0aCA9IFwiL1wiICsgcGF0aDtcbiAgICB9XG4gICAgaWYgKHBhdGguc3Vic3RyaW5nKHBhdGgubGVuZ3RoLTIpID09IFwiL1wiKSB7XG4gICAgICAgIHBhdGggPSBcIi9cIiArIHBhdGg7XG4gICAgfVxuICAgIHZhciByb3V0ZSA9IHtcbiAgICAgICAgcGF0aDogcGF0aCxcbiAgICAgICAgZGVwdGg6IChwYXRoLnNwbGl0KFwiL1wiKS5sZW5ndGggLSAxKSxcbiAgICAgICAgdmFyczogW10sXG4gICAgICAgIG51bVZhcnM6IDBcbiAgICB9O1xuICAgIHNtYXNoLnJvdXRlci5fX2R5bmFtaWNQYXJ0cyA9IHBhdGgubWF0Y2goc21hc2gucm91dGVyLl9fcGFyc2VSb3V0ZVJlZ2V4KTtcbiAgICBpZiAoc21hc2gucm91dGVyLl9fZHluYW1pY1BhcnRzICE9IHVuZGVmaW5lZCAmJiBzbWFzaC5yb3V0ZXIuX19keW5hbWljUGFydHMgIT0gbnVsbCkge1xuICAgICAgICB2YXIgcmVnZXggPSBcIl5cIiArIHBhdGgucmVwbGFjZSgvXFwvL2lnLCBcIlxcXFwvXCIpICsgXCIkXCI7XG4gICAgICAgIGZvciAodmFyIGk9MDsgaTxzbWFzaC5yb3V0ZXIuX19keW5hbWljUGFydHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHJvdXRlLm51bVZhcnMrKztcbiAgICAgICAgICAgIHJvdXRlLnZhcnMucHVzaChzbWFzaC5yb3V0ZXIuX19keW5hbWljUGFydHNbaV0uc3Vic3RyaW5nKDEsIHNtYXNoLnJvdXRlci5fX2R5bmFtaWNQYXJ0c1tpXS5sZW5ndGgtMSkpO1xuICAgICAgICAgICAgcmVnZXggPSByZWdleC5yZXBsYWNlKHNtYXNoLnJvdXRlci5fX2R5bmFtaWNQYXJ0c1tpXSwgXCIoLio/KVwiKTtcbiAgICAgICAgfVxuICAgICAgICByb3V0ZS5yZWdleCA9IG5ldyBSZWdFeHAocmVnZXgsICdpJyk7XG4gICAgfVxuICAgIHJldHVybiByb3V0ZTtcbn07XG5cbnNtYXNoLnJvdXRlci5xdWVyeVBhcmFtID0gZnVuY3Rpb24ocGFyYW0pIHtcbiAgICB2YXIgcmVnZXhTID0gXCJbXFxcXD8mXVwiK3BhcmFtK1wiPShbXiYjXSopXCIsXG4gICAgcmVnZXggPSBuZXcgUmVnRXhwKCByZWdleFMgKSxcbiAgICByZXN1bHRzID0gcmVnZXguZXhlYyggd2luZG93LmxvY2F0aW9uLnNlYXJjaCApO1xuICAgIGlmKCByZXN1bHRzID09IG51bGwgKXtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdHNbMV07Ly9kZWNvZGVVUklDb21wb25lbnQocmVzdWx0c1sxXS5yZXBsYWNlKC9cXCsvZywgXCIgXCIpKTtcbn07XG4iLCJzbWFzaC5zZWFyY2hib3ggPSB7XG4gICAgaV86IGZhbHNlLFxuICAgIG1pbkF1dG9Db21wbGV0ZUxlbmd0aDogMyxcbiAgICBvbmZvY3VzOiB1bmRlZmluZWQsXG4gICAgb25ibHVyOiB1bmRlZmluZWQsXG4gICAgb252YWx1ZTogdW5kZWZpbmVkLFxufTtcblxuc21hc2guc2VhcmNoYm94LmluaXQgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAoc21hc2guc2VhcmNoYm94LmlfKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHNzYiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc21hc2gtc2VhcmNoYm94IGlucHV0XCIpO1xuICAgIGlmICghc3NiKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgc3NiLm9uZm9jdXMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMudmFsdWUubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgIHNtYXNoLnNlYXJjaGJveC5yZXN1bHRzKCc8ZGl2IGNsYXNzPVwic21hc2gtaW5zdHJ1Y3Rpb25cIj5TdGFydCB0eXBpbmcgdG8gZmluZCByZXN1bHRzPC9kaXY+Jyk7XG4gICAgICAgIH1cbiAgICAgICAgc21hc2guY2xhc3MuYWRkKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc21hc2gtaGVhZGVyXCIpLCAnaXMtZm9jdXNzZWQnKTtcbiAgICAgICAgc21hc2guY2xhc3MuYWRkKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc21hc2gtc2VhcmNoYm94IC5zbWFzaC1zZWFyY2hib3gtcmVzdWx0c1wiKSwgJ3Nob3cnKTtcbiAgICAgICAgaWYgKHNtYXNoLnNlYXJjaGJveC5vbmZvY3VzKSB7XG4gICAgICAgICAgICBzbWFzaC5zZWFyY2hib3gub25mb2N1cygpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBzc2Iub25ibHVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHNtYXNoLmNsYXNzLnJlbW92ZShkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNtYXNoLWhlYWRlclwiKSwgJ2lzLWZvY3Vzc2VkJyk7XG4gICAgICAgIHNtYXNoLmNsYXNzLnJlbW92ZShkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNtYXNoLXNlYXJjaGJveCAuc21hc2gtc2VhcmNoYm94LXJlc3VsdHNcIiksICdzaG93Jyk7XG4gICAgICAgIGlmIChzbWFzaC5zZWFyY2hib3gub25ibHVyKSB7XG4gICAgICAgICAgICBzbWFzaC5zZWFyY2hib3gub25ibHVyKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHNzYi5vbmtleXVwID0gZnVuY3Rpb24oZSkge1xuICAgICAgICBpZiAodGhpcy52YWx1ZS5sZW5ndGggPCBzbWFzaC5zZWFyY2hib3gubWluQXV0b0NvbXBsZXRlTGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNtYXNoLnNlYXJjaGJveC5vbmNoYW5nZSkge1xuICAgICAgICAgICAgc21hc2guc2VhcmNoYm94Lm9uY2hhbmdlKHRoaXMudmFsdWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBzbWFzaC5zZWFyY2hib3guaV8gPSB0cnVlO1xufTtcblxuc21hc2guc2VhcmNoYm94LnJlc3VsdHMgPSBmdW5jdGlvbihjb250ZW50KSB7XG4gICAgdmFyIHJlc3VsdHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNtYXNoLXNlYXJjaGJveCAuc21hc2gtc2VhcmNoYm94LXJlc3VsdHNcIik7XG4gICAgcmVzdWx0cy5pbm5lckhUTUwgPSBjb250ZW50O1xufTtcbiIsInNtYXNoLnNpZGViYXIgPSB7XG4gICAgaV86IGZhbHNlXG59O1xuXG5zbWFzaC5zaWRlYmFyLmluaXQgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAoc21hc2guc2lkZWJhci5pXykge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBzaWJsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zbWFzaC1zaWRlYmFyIC5sb2NrXCIpO1xuICAgIGlmICghc2libCkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHNpYmwub25jbGljayA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBzbWFzaC5zaWRlYmFyLnRvZ2dsZUxvY2soKTtcbiAgICB9O1xuXG4gICAgdmFyIHNpYiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc21hc2gtc2lkZWJhclwiKTtcbiAgICBzbWFzaC5jbGFzcy5hZGQoc2liLCAnaXMtdW5sb2NrZWQnKTtcbiAgICBzbWFzaC5zaWRlYmFyLmlfID0gdHJ1ZTtcbiAgICBpZiAoc21hc2guY29uZmlnLmdldCgnc2lkZWJhcl9sb2NrJykpIHtcbiAgICAgICAgc21hc2guc2lkZWJhci50b2dnbGVMb2NrKCk7XG4gICAgfVxufTtcblxuc21hc2guc2lkZWJhci50b2dnbGVMb2NrID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKCFzbWFzaC5zaWRlYmFyLmlfKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgc21hc2guY2xhc3MudG9nZ2xlKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc21hc2gtc2lkZWJhciAubG9ja1wiKSwgJ3VubG9jaycpO1xuICAgIHNtYXNoLmNsYXNzLnRvZ2dsZShkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNtYXNoLXNpZGViYXJcIiksICdpcy11bmxvY2tlZCcpO1xuICAgIHNtYXNoLmNvbmZpZy5zZXQoJ3NpZGViYXJfbG9jaycsICFzbWFzaC5jbGFzcy5oYXMoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zbWFzaC1zaWRlYmFyXCIpLCAnaXMtdW5sb2NrZWQnKSk7XG59O1xuIiwic21hc2guc3RvcmFnZSA9IHt9O1xuXG5zbWFzaC5zdG9yYWdlLnNldCA9IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShrZXksIEpTT04uc3RyaW5naWZ5KHZhbHVlKSk7XG59O1xuXG5zbWFzaC5zdG9yYWdlLnVuc2V0ID0gZnVuY3Rpb24oa2V5KSB7XG4gICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oa2V5KTtcbn07XG5cbnNtYXNoLnN0b3JhZ2UuZ2V0ID0gZnVuY3Rpb24oa2V5KSB7XG4gICAgdmFyIGkgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpO1xuICAgIGlmICghaSkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICByZXR1cm4gSlNPTi5wYXJzZShpKTtcbn07XG5cbnNtYXNoLnN0b3JhZ2UuY2xlYXIgPSBmdW5jdGlvbigpIHtcbiAgICBsb2NhbFN0b3JhZ2UuY2xlYXIoKTtcbn07XG4iLCJzbWFzaC53b3Jrc3BhY2UgPSB7XG4gICAgYmFzZVRpdGxlOiB1bmRlZmluZWQsXG4gICAgX3dzXzogdW5kZWZpbmVkLFxuICAgIF9oZHJfOiB1bmRlZmluZWQsXG4gICAgX3NiXzogdW5kZWZpbmVkLFxuICAgIF90YWJzXzogW11cbn07XG5cbnNtYXNoLndvcmtzcGFjZS5pbml0ID0gZnVuY3Rpb24oKSB7XG4gICAgc21hc2gud29ya3NwYWNlLl93c18gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNtYXNoLXdvcmtzcGFjZVwiKTtcbiAgICBpZiAoIXNtYXNoLndvcmtzcGFjZS5fd3NfKSB7XG4gICAgICAgIHJldHVyblxuICAgIH1cbiAgICBzbWFzaC53b3Jrc3BhY2UuX2hkcl8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNtYXNoLWhlYWRlclwiKTtcbiAgICBpZiAoc21hc2gud29ya3NwYWNlLl9oZHJfKSB7XG4gICAgICAgIHNtYXNoLmNsYXNzLmFkZChzbWFzaC53b3Jrc3BhY2UuX3dzXywgJ2hhcy1oZWFkZXInKTtcbiAgICB9XG4gICAgc21hc2gud29ya3NwYWNlLl9zYl8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNtYXNoLXdvcmtzcGFjZSAuc21hc2gtc2lkZWJhclwiKTtcbiAgICBpZiAoc21hc2gud29ya3NwYWNlLl9zYl8pIHtcbiAgICAgICAgc21hc2guY2xhc3MuYWRkKHNtYXNoLndvcmtzcGFjZS5fd3NfLCAnaGFzLXNpZGViYXInKTtcbiAgICB9XG59O1xuXG5zbWFzaC53b3Jrc3BhY2UuYWRkVGFiID0gZnVuY3Rpb24oaWQsIHRpdGxlLCBjb250ZW50LCB1cmwpIHtcbiAgICBpZiAoIXNtYXNoLmdldChkb2N1bWVudCwgJy5zbWFzaC10YWItcGFuZScpKSB7XG4gICAgICAgIHZhciBwYW5lbCA9IHNtYXNoLmdldChkb2N1bWVudCwgJy5zbWFzaC1wYW5lbCcpO1xuICAgICAgICBpZiAoIXBhbmVsKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnVG8gYWRkIGEgdGFiIHRoZXJlIG5lZWRzIHRvIGJlIGEgcGFuZWwnKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBwYW5lbC5pbm5lckhUTUwgPSAnPGRpdiBjbGFzcz1cInNtYXNoLXRhYi1wYW5lXCI+PGRpdiBjbGFzcz1cInNtYXNoLXRhYnNcIj48L2Rpdj48ZGl2IGNsYXNzPVwic21hc2gtcGFuZXNcIj48L2Rpdj48L2Rpdj4nO1xuICAgIH1cbiAgICB2YXIgdGFicyA9IHNtYXNoLmdldChkb2N1bWVudCwgJy5zbWFzaC10YWItcGFuZSAuc21hc2gtdGFicycpO1xuICAgIHZhciBwYW5lc0NvbnRhaW5lciA9IHNtYXNoLmdldChkb2N1bWVudCwgJy5zbWFzaC10YWItcGFuZSAuc21hc2gtcGFuZXMnKTtcblxuICAgIGRvY3VtZW50LnRpdGxlID0gc21hc2gud29ya3NwYWNlLmNyZWF0ZVRpdGxlKHRpdGxlKTtcblxuICAgIGlmICh0YWIgPSBzbWFzaC5nZXQodGFicywgJy5zbWFzaC10YWJbZGF0YS1pZD1cIicgKyBpZCArICdcIl0nKSkge1xuICAgICAgICB2YXIgcGFuZSA9IHNtYXNoLmdldChwYW5lc0NvbnRhaW5lciwgJy5zbWFzaC1wYW5lW2RhdGEtaWQ9XCInICsgaWQgKyAnXCJdJyk7XG4gICAgICAgIHBhbmUuaW5uZXJIVE1MID0gY29udGVudDtcbiAgICAgICAgdGFiLmRhdGFzZXQudXJsID0gdXJsO1xuICAgICAgICB0YWIub25jbGljaygpO1xuICAgICAgICByZXR1cm4ge3RhYjogdGFiLCBwYW5lOiBwYW5lfTtcbiAgICB9XG5cbiAgICBzbWFzaC5oaWRlKHBhbmVzQ29udGFpbmVyLCBcIi5zbWFzaC1wYW5lXCIpO1xuICAgIGlmIChhY3RpdmUgPSBzbWFzaC5nZXQodGFicywgJy5zbWFzaC10YWIuYWN0aXZlJykpIHtcbiAgICAgICAgc21hc2guY2xhc3MucmVtb3ZlKGFjdGl2ZSwgJ2FjdGl2ZScpO1xuICAgIH1cblxuICAgIC8vIENyZWF0ZSBhIG5ldyB0YWJcbiAgICB2YXIgdGFiID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICB0YWIuY2xhc3NOYW1lID0gJ3NtYXNoLXRhYiBhY3RpdmUnO1xuICAgIHRhYi5kYXRhc2V0LmlkID0gaWQ7XG4gICAgdGFiLmRhdGFzZXQudXJsID0gdXJsO1xuICAgIHRhYi5pbm5lckhUTUwgPSB0aXRsZSArICc8aSBjbGFzcz1cIm1hdGVyaWFsLWljb25zIGNsb3NlXCI+Y2xvc2U8L2k+JztcbiAgICB0YWIub25jbGljayA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgaWYgKGFjdGl2ZSA9IHNtYXNoLmdldCh0YWJzLCAnLnNtYXNoLXRhYi5hY3RpdmUnKSkge1xuICAgICAgICAgICAgc21hc2guY2xhc3MucmVtb3ZlKGFjdGl2ZSwgJ2FjdGl2ZScpO1xuICAgICAgICB9XG4gICAgICAgIHNtYXNoLmNsYXNzLmFkZCh0aGlzLCAnYWN0aXZlJyk7XG4gICAgICAgIHNtYXNoLmhpZGUoZG9jdW1lbnQsICcuc21hc2gtcGFuZScpO1xuICAgICAgICBzbWFzaC5zaG93KGRvY3VtZW50LCAnLnNtYXNoLXBhbmVbZGF0YS1pZD1cIicgKyB0aGlzLmRhdGFzZXQuaWQgKyAnXCJdJyk7XG4gICAgICAgIGlmICh0aGlzLmRhdGFzZXQudXJsICYmIHRoaXMuZGF0YXNldC51cmwgIT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgICAgc21hc2gucm91dGVyLmRpc3BsYXlVUkwodGhpcy5kYXRhc2V0LnVybCk7XG4gICAgICAgIH1cbiAgICAgICAgZG9jdW1lbnQudGl0bGUgPSBzbWFzaC53b3Jrc3BhY2UuY3JlYXRlVGl0bGUodGhpcy5pbm5lckhUTUwpO1xuICAgIH07XG4gICAgc21hc2gub24odGFiLCAnLmNsb3NlJywgJ29uY2xpY2snLCBmdW5jdGlvbihlKSB7XG4gICAgICAgIGlmIChzbWFzaC5jbGFzcy5oYXModGhpcy5wYXJlbnRFbGVtZW50LCAnYWN0aXZlJykpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudEVsZW1lbnQucHJldmlvdXNTaWJsaW5nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJlbnRFbGVtZW50LnByZXZpb3VzU2libGluZy5vbmNsaWNrKCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMucGFyZW50RWxlbWVudC5uZXh0U2libGluZykge1xuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50RWxlbWVudC5uZXh0U2libGluZy5vbmNsaWNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhbmUgPSBzbWFzaC5nZXQoZG9jdW1lbnQsICcuc21hc2gtcGFuZVtkYXRhLWlkPVwiJyArIHRoaXMucGFyZW50RWxlbWVudC5kYXRhc2V0LmlkICsgJ1wiXScpKSB7XG4gICAgICAgICAgICBwYW5lLnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQocGFuZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQodGhpcy5wYXJlbnRFbGVtZW50KTtcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICB9KTtcbiAgICB0YWJzLmFwcGVuZENoaWxkKHRhYik7XG5cbiAgICAvLyBDcmVhdGUgYSBuZXcgcGFuZSB3aXRoIHRoZSBwcm92aWRlZCBjb250ZW50XG4gICAgdmFyIHBhbmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIHBhbmUuY2xhc3NOYW1lID0gJ3NtYXNoLXBhbmUnO1xuICAgIHBhbmUuZGF0YXNldC5pZCA9IGlkO1xuICAgIHBhbmUuaW5uZXJIVE1MID0gY29udGVudDtcbiAgICBwYW5lc0NvbnRhaW5lci5hcHBlbmRDaGlsZChwYW5lKTtcbiAgICByZXR1cm4ge3RhYjogdGFiLCBwYW5lOiBwYW5lfTtcbn07XG5cbnNtYXNoLndvcmtzcGFjZS5hY3RpdmVUYWIgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgdGFiID0gc21hc2guZ2V0KHRhYnMsICcuc21hc2gtdGFiLmFjdGl2ZScpXG4gICAgaWYgKCF0YWIpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBwYW5lID0gc21hc2guZ2V0KGRvY3VtZW50LCAnLnNtYXNoLXBhbmVbZGF0YS1pZD1cIicgKyB0YWIuZGF0YXNldC5pZCArICdcIl0nKTtcbiAgICBpZiAoIXBhbmUpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHJldHVybiB7dGFiOiB0YWIsIHBhbmU6IHBhbmV9O1xufTtcblxuc21hc2gud29ya3NwYWNlLmNyZWF0ZVRpdGxlID0gZnVuY3Rpb24odGl0bGUpIHtcbiAgICByZXR1cm4gdGl0bGUucmVwbGFjZSgvPChbXj5dKz8pKFtePl0qPyk+KC4qPyk8XFwvXFwxPi9pZywgXCJcIikgKyAoc21hc2gud29ya3NwYWNlLmJhc2VUaXRsZSA/ICcgfCAnICsgc21hc2gud29ya3NwYWNlLmJhc2VUaXRsZSA6IFwiXCIpXG59O1xuIl19
