window.onload=function(s){smash.init()};var smash={};smash.init=function(){smash.config.init(),smash.sidebar.init(),smash.searchbox.init(),smash.workspace.init(),smash.input.init()},smash.get=function(s,e){try{return s.querySelector(e)}catch(s){console.log(s)}},smash.getAll=function(s,e){try{return s.querySelectorAll(e)}catch(s){console.log(s)}},smash.hide=function(s,e){for(var a=smash.getAll(s,e),t=0;t<a.length;t++)a[t].style.display="none"},smash.show=function(s,e){for(var a=smash.getAll(s,e),t=0;t<a.length;t++)a[t].style.display=""},smash.ajax={},smash.ajax.x=function(){if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;for(var s,e=["MSXML2.XmlHttp.6.0","MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"],a=0;a<e.length;a++)try{s=new ActiveXObject(e[a]);break}catch(s){}return s},smash.ajax.send=function(s,e,a,t,n,o){void 0===o&&(o=!0);var r=smash.ajax.x();r.responseType=n,r.open(a,s,o),r.onreadystatechange=function(){4==r.readyState&&(200==r.status||201==r.status?e&&e(r.response):console.log(r.status,r.response))},"POST"==a&&r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.send(t)},smash.ajax.get=function(s,e,a,t,n){var o=[];for(var r in a)o.push(encodeURIComponent(r)+"="+encodeURIComponent(a[r]));smash.ajax.send(s+(o.length?"?"+o.join("&"):""),e,"GET",null,t,n)},smash.ajax.post=function(s,e,a,t,n){var o;if(a)if("json"!=t){var r=[];for(var i in a)r.push(encodeURIComponent(i)+"="+encodeURIComponent(a[i]));o=r.join("&")}else o=JSON.stringify(a);smash.ajax.send(s,e,"POST",o,t,n)},smash.class={},smash.class.add=function(s,e){smash.class.has(s,e)||(s.classList?s.classList.add(e):s.className+=" "+e)},smash.class.remove=function(s,e){smash.class.has(s,e)&&(s.classList?s.classList.remove(e):s.className=s.className.replace(e,""))},smash.class.has=function(s,e){return(" "+s.className+" ").replace(/[\n\t]/g," ").indexOf(" "+e+" ")>-1},smash.class.toggle=function(s,e){smash.class.has(s,e)?smash.class.remove(s,e):smash.class.add(s,e)},smash.config={_values_:{_sidebar_lock_:!1}},smash.config.init=function(){var s=smash.storage.get("config");s&&(smash.config._values_=s)},smash.config.get=function(s){var e="_"+s+"_";if(e in smash.config._values_)return smash.config._values_[e];throw new smash.Exception("001",'Invalid config option "'+s+'"')},smash.config.set=function(s,e){var a="_"+s+"_";if(!a in smash.config._values_)throw new smash.Exception("001",'Invalid config option "'+s+'"');smash.config._values_[a]=e,smash.storage.set("config",smash.config._values_)},smash.Exception=function(s,e){this.value=s,this.message=e,this.toString=function(){return"SmashException "+this.value+": "+this.message}},smash.input={},smash.input.init=function(){for(var s,e=document.querySelectorAll(".smash-input.has-floating-label input"),a=0;a<e.length;a++){s=e[a],smash.class.remove(s.parentElement,"has-floating-label"),smash.class.add(s.parentElement,"floating-label");var t=document.createElement("label");t.innerHTML=s.placeholder,s.parentElement.appendChild(t),s.onkeyup=function(s){var e=this.parentElement.querySelector("label");e&&(""!=s.srcElement.value?smash.class.add(e,"show"):smash.class.remove(e,"show"))}}for(var n,o=document.querySelectorAll(".smash-select select"),a=0;a<o.length;a++){if(n=o[a],smash.class.has(n.parentElement,"has-floating-label")){smash.class.remove(n.parentElement,"has-floating-label"),smash.class.add(n.parentElement,"floating-label");var t=document.createElement("label");t.innerHTML=n.getAttribute("placeholder"),n.parentElement.appendChild(t)}var s=document.createElement("input");s.type="text",s.placeholder=n.getAttribute("placeholder"),s.setAttribute("readonly","readonly"),n.parentElement.appendChild(s);for(var r=n.querySelectorAll("option"),i=document.createElement("ul"),c=0;c<r.length;c++){var h=r[c];if(h.getAttribute("value")){var m=document.createElement("li");m.setAttribute("value",h.value),m.innerHTML=h.innerHTML,i.appendChild(m),m.onmousedown=function(s){var e=this.getAttribute("value"),a=this.parentElement.parentElement;smash.class.remove(a,"is-focussed"),window.onmousedown=null,a.querySelector("select").value=e,a.querySelector("input").value=this.innerHTML,a.querySelector("input").focus(),a.querySelector("input").onfocus(),s.stopPropagation()}}}n.parentElement.appendChild(i),s.onfocus=function(s){var e=this.parentElement.querySelector("label");e&&(""!=this.value?smash.class.add(e,"show"):smash.class.remove(e,"show"))},n.parentElement.onclick=function(){smash.class.add(this,"is-focussed");var s=this;window.onmousedown=function(){console.log("click outside"),window.onmousedown=null,smash.class.remove(s,"is-focussed")}}}},smash.router={__parseRouteRegex:/{(.*?)}/gi,__dynamicParts:[],__routes:{static:[],dynamic:[]}},smash.router.add=function(s,e){var a=smash.router.parseRoute(s);return a.regex?(a.callback=e,smash.router.__routes.dynamic[a.depth]||(smash.router.__routes.dynamic[a.depth]=[]),smash.router.__routes.dynamic[a.depth][a.numVars]||(smash.router.__routes.dynamic[a.depth][a.numVars]=[]),void smash.router.__routes.dynamic[a.depth][a.numVars].push(a)):void(smash.router.__routes.static[s]=e)},smash.router.set=function(s){window.history.pushState("","",s),window.dispatchEvent(new Event("popstate"))},smash.router.redirect=function(s){window.location=s},smash.router.handleNotFound=function(s){console.log("route: "+JSON.stringify(s)+" does not exist")},smash.router.run=function(){window.onpopstate=function(s){smash.router.execute()},smash.router.execute()},smash.router.execute=function(){var s=this.getPath();if(this.__routes.static[s.path])return void this.__routes.static[s.path]();var e=s.path.split("/").length-1;if(this.__routes.dynamic[e]){var a,t,n={};for(var o in this.__routes.dynamic[e])for(var r in this.__routes.dynamic[e][o]){var a=this.__routes.dynamic[e][o][r];if(t=s.path.match(a.regex)){for(var i=0;i<a.numVars;i++)n[a.vars[i]]=t[i+1];return void a.callback(n)}}}smash.router.handleNotFound(s)},smash.router.getPath=function(){var s=document.createElement("a");return s.href=window.location,{host:s.hostname,path:s.pathname}},smash.router.parseRoute=function(s){"/"!=s.substring(0,1)&&(s="/"+s),"/"==s.substring(s.length-2)&&(s="/"+s);var e={path:s,depth:s.split("/").length-1,vars:[],numVars:0};if(smash.router.__dynamicParts=s.match(smash.router.__parseRouteRegex),void 0!=smash.router.__dynamicParts&&null!=smash.router.__dynamicParts){for(var a="^"+s.replace(/\//gi,"\\/")+"$",t=0;t<smash.router.__dynamicParts.length;t++)e.numVars++,e.vars.push(smash.router.__dynamicParts[t].substring(1,smash.router.__dynamicParts[t].length-1)),a=a.replace(smash.router.__dynamicParts[t],"(.*?)");e.regex=new RegExp(a,"i")}return e},smash.searchbox={i_:!1},smash.searchbox.init=function(){if(!smash.searchbox.i_){var s=document.querySelector(".smash-searchbox input");s&&(s.onfocus=function(){smash.class.add(document.querySelector(".smash-header"),"is-focussed")},s.onblur=function(){smash.class.remove(document.querySelector(".smash-header"),"is-focussed")}),smash.searchbox.i_=!0}},smash.sidebar={i_:!1},smash.sidebar.init=function(){if(!smash.sidebar.i_){var s=document.querySelector(".smash-sidebar .lock");if(s){s.onclick=function(){smash.sidebar.toggleLock()};var e=document.querySelector(".smash-sidebar");smash.class.add(e,"is-unlocked"),smash.sidebar.i_=!0,smash.config.get("sidebar_lock")&&smash.sidebar.toggleLock()}}},smash.sidebar.toggleLock=function(){smash.sidebar.i_&&(smash.class.toggle(document.querySelector(".smash-sidebar .lock"),"unlock"),smash.class.toggle(document.querySelector(".smash-sidebar"),"is-unlocked"),smash.config.set("sidebar_lock",!smash.class.has(document.querySelector(".smash-sidebar"),"is-unlocked")))},smash.storage={},smash.storage.set=function(s,e){localStorage.setItem(s,JSON.stringify(e))},smash.storage.get=function(s){var e=localStorage.getItem(s);if(e)return JSON.parse(e)},smash.storage.clear=function(){localStorage.clear()},smash.workspace={_ws_:void 0,_hdr_:void 0,_sb_:void 0},smash.workspace.init=function(){smash.workspace._ws_=document.querySelector(".smash-workspace"),smash.workspace._ws_&&(smash.workspace._hdr_=document.querySelector(".smash-header"),smash.workspace._hdr_&&smash.class.add(smash.workspace._ws_,"has-header"),smash.workspace._sb_=document.querySelector(".smash-workspace .smash-sidebar"),smash.workspace._sb_&&smash.class.add(smash.workspace._ws_,"has-sidebar"))},smash.workspace.addTab=function(s,e,a){if(!smash.get(document,".smash-tab-pane")){var t=smash.get(document,".smash-panel");if(!t)return void console.log("To add a tab there needs to be a panel");t.innerHTML='<div class="smash-tab-pane"><div class="smash-tabs"></div><div class="smash-panes"></div></div>'}var n=smash.get(document,".smash-tab-pane .smash-tabs"),o=smash.get(document,".smash-tab-pane .smash-panes");smash.hide(o,".smash-pane"),(active=smash.get(n,".smash-tab.active"))&&smash.class.remove(active,"active"),n.innerHTML=n.innerHTML+'<div class="smash-tab active" data-id="'+s+'">'+e+'<i class="material-icons close">close</i></div>',o.innerHTML=o.innerHTML+'<div class="smash-pane" data-id="'+s+'">'+a+"</div>",(test=smash.get(n,".smash-tab.active"))&&(console.log("test 1"),test.onclick=function(s){console.log("test"),(active=smash.get(n,".smash-tab.active"))&&smash.class.remove(active,"active"),smash.class.add(this,"active")})};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNtYXNoLmpzIiwiYWpheC5qcyIsImNsYXNzLmpzIiwiY29uZmlnLmpzIiwiZXhjZXB0aW9uLmpzIiwiaW5wdXQuanMiLCJyb3V0ZXIuanMiLCJzZWFyY2hib3guanMiLCJzaWRlYmFyLmpzIiwic3RvcmFnZS5qcyIsIndvcmtzcGFjZS5qcyJdLCJuYW1lcyI6WyJ3aW5kb3ciLCJvbmxvYWQiLCJlIiwic21hc2giLCJpbml0IiwiY29uZmlnIiwic2lkZWJhciIsInNlYXJjaGJveCIsIndvcmtzcGFjZSIsImlucHV0IiwiZ2V0IiwicGFyZW50Iiwic2VsZWN0b3IiLCJxdWVyeVNlbGVjdG9yIiwiY29uc29sZSIsImxvZyIsImdldEFsbCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJoaWRlIiwiZWwiLCJpIiwibGVuZ3RoIiwic3R5bGUiLCJkaXNwbGF5Iiwic2hvdyIsImFqYXgiLCJ4IiwiWE1MSHR0cFJlcXVlc3QiLCJ4aHIiLCJ2ZXJzaW9ucyIsIkFjdGl2ZVhPYmplY3QiLCJzZW5kIiwidXJsIiwiY2FsbGJhY2siLCJtZXRob2QiLCJkYXRhIiwicmVzcG9uc2VUeXBlIiwiYXN5bmMiLCJ1bmRlZmluZWQiLCJvcGVuIiwib25yZWFkeXN0YXRlY2hhbmdlIiwicmVhZHlTdGF0ZSIsInN0YXR1cyIsInJlc3BvbnNlIiwic2V0UmVxdWVzdEhlYWRlciIsInF1ZXJ5Iiwia2V5IiwicHVzaCIsImVuY29kZVVSSUNvbXBvbmVudCIsImpvaW4iLCJwb3N0IiwiZGF0YVN0ciIsIkpTT04iLCJzdHJpbmdpZnkiLCJjbGFzcyIsImFkZCIsImNsYXNzTmFtZSIsImhhcyIsImNsYXNzTGlzdCIsInJlbW92ZSIsInJlcGxhY2UiLCJpbmRleE9mIiwidG9nZ2xlIiwiX3ZhbHVlc18iLCJfc2lkZWJhcl9sb2NrXyIsInYiLCJzdG9yYWdlIiwib3B0aW9uIiwibyIsIkV4Y2VwdGlvbiIsInNldCIsInZhbHVlIiwibWVzc2FnZSIsInRoaXMiLCJ0b1N0cmluZyIsImlucHV0cyIsImRvY3VtZW50IiwicGFyZW50RWxlbWVudCIsImxhYmVsIiwiY3JlYXRlRWxlbWVudCIsImlubmVySFRNTCIsInBsYWNlaG9sZGVyIiwiYXBwZW5kQ2hpbGQiLCJvbmtleXVwIiwibCIsInNyY0VsZW1lbnQiLCJzZWxlY3QiLCJzZWxlY3RzIiwiZ2V0QXR0cmlidXRlIiwidHlwZSIsInNldEF0dHJpYnV0ZSIsIm9wdGlvbnMiLCJ1bCIsImoiLCJsaSIsIm9ubW91c2Vkb3duIiwidmFsIiwiZm9jdXMiLCJvbmZvY3VzIiwic3RvcFByb3BhZ2F0aW9uIiwib25jbGljayIsInJvdXRlciIsIl9fcGFyc2VSb3V0ZVJlZ2V4IiwiX19keW5hbWljUGFydHMiLCJfX3JvdXRlcyIsInN0YXRpYyIsImR5bmFtaWMiLCJwYXRoIiwicm91dGUiLCJwYXJzZVJvdXRlIiwicmVnZXgiLCJkZXB0aCIsIm51bVZhcnMiLCJoaXN0b3J5IiwicHVzaFN0YXRlIiwiZGlzcGF0Y2hFdmVudCIsIkV2ZW50IiwicmVkaXJlY3QiLCJsb2NhdGlvbiIsImhhbmRsZU5vdEZvdW5kIiwicnVuIiwib25wb3BzdGF0ZSIsImV2ZW50IiwiZXhlY3V0ZSIsImdldFBhdGgiLCJzcGxpdCIsIm1hdGNoZXMiLCJ2YXJOdW0iLCJpdGVtIiwibWF0Y2giLCJ2YXJzIiwiaHJlZiIsImhvc3QiLCJob3N0bmFtZSIsInBhdGhuYW1lIiwic3Vic3RyaW5nIiwiUmVnRXhwIiwiaV8iLCJzc2IiLCJvbmJsdXIiLCJzaWJsIiwidG9nZ2xlTG9jayIsInNpYiIsIm5hbWUiLCJsb2NhbFN0b3JhZ2UiLCJzZXRJdGVtIiwiZ2V0SXRlbSIsInBhcnNlIiwiY2xlYXIiLCJfd3NfIiwiX2hkcl8iLCJfc2JfIiwiYWRkVGFiIiwiaWQiLCJ0aXRsZSIsImNvbnRlbnQiLCJwYW5lbCIsInRhYnMiLCJwYW5lc0NvbnRhaW5lciIsImFjdGl2ZSIsInRlc3QiXSwibWFwcGluZ3MiOiJBQUFBQSxPQUFBQyxPQUFBLFNBQUFDLEdBQ0FDLE1BQUFDLE9BR0EsSUFBQUQsU0FFQUEs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QyxFQUFBQyxHQUNBLElBQUF4SixNQUFBTyxJQUFBa0UsU0FBQSxtQkFBQSxDQUNBLEdBQUFnRixHQUFBekosTUFBQU8sSUFBQWtFLFNBQUEsZUFDQSxLQUFBZ0YsRUFFQSxXQURBOUksU0FBQUMsSUFBQSx5Q0FHQTZJLEdBQUE1RSxVQUFBLGtHQUVBLEdBQUE2RSxHQUFBMUosTUFBQU8sSUFBQWtFLFNBQUEsK0JBQ0FrRixFQUFBM0osTUFBQU8sSUFBQWtFLFNBQUEsK0JBRUF6RSxPQUFBZSxLQUFBNEksRUFBQSxnQkFDQUMsT0FBQTVKLE1BQUFPLElBQUFtSixFQUFBLHVCQUNBMUosTUFBQW1ELE1BQUFLLE9BQUFvRyxPQUFBLFVBRUFGLEVBQUE3RSxVQUFBNkUsRUFBQTdFLFVBQUEsMENBQUF5RSxFQUFBLEtBQUFDLEVBQUEsa0RBQ0FJLEVBQUE5RSxVQUFBOEUsRUFBQTlFLFVBQUEsb0NBQUF5RSxFQUFBLEtBQUFFLEVBQUEsVUFDQUssS0FBQTdKLE1BQUFPLElBQUFtSixFQUFBLHdCQUNBL0ksUUFBQUMsSUFBQSxVQUNBaUosS0FBQTVELFFBQUEsU0FBQWxHLEdBQ0FZLFFBQUFDLElBQUEsU0FDQWdKLE9BQUE1SixNQUFBTyxJQUFBbUosRUFBQSx1QkFDQTFKLE1BQUFtRCxNQUFBSyxPQUFBb0csT0FBQSxVQUVBNUosTUFBQW1ELE1BQUFDLElBQUFrQixLQUFBIiwiZmlsZSI6InNtYXNoLmpzIiwic291cmNlc0NvbnRlbnQiOlsid2luZG93Lm9ubG9hZCA9IGZ1bmN0aW9uKGUpe1xuICAgIHNtYXNoLmluaXQoKTtcbn1cblxudmFyIHNtYXNoID0ge307XG5cbnNtYXNoLmluaXQgPSBmdW5jdGlvbigpIHtcbiAgICBzbWFzaC5jb25maWcuaW5pdCgpO1xuICAgIHNtYXNoLnNpZGViYXIuaW5pdCgpO1xuICAgIHNtYXNoLnNlYXJjaGJveC5pbml0KCk7XG4gICAgc21hc2gud29ya3NwYWNlLmluaXQoKTtcbiAgICBzbWFzaC5pbnB1dC5pbml0KCk7XG59O1xuXG5zbWFzaC5nZXQgPSBmdW5jdGlvbihwYXJlbnQsIHNlbGVjdG9yKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIHBhcmVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcbiAgICB9IGNhdGNoKGUpIHtcbiAgICAgICAgY29uc29sZS5sb2coZSk7XG4gICAgfVxuICAgIHJldHVybiB1bmRlZmluZWQ7XG59O1xuXG5zbWFzaC5nZXRBbGwgPSBmdW5jdGlvbihwYXJlbnQsIHNlbGVjdG9yKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIHBhcmVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKTtcbiAgICB9IGNhdGNoKGUpIHtcbiAgICAgICAgY29uc29sZS5sb2coZSk7XG4gICAgfVxuICAgIHJldHVybiB1bmRlZmluZWQ7XG59O1xuXG5zbWFzaC5oaWRlID0gZnVuY3Rpb24ocGFyZW50LCBzZWxlY3Rvcikge1xuICAgIHZhciBlbCA9IHNtYXNoLmdldEFsbChwYXJlbnQsIHNlbGVjdG9yKTtcbiAgICBmb3IgKHZhciBpPTA7IGk8ZWwubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZWxbaV0uc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICB9XG59O1xuXG5zbWFzaC5zaG93ID0gZnVuY3Rpb24ocGFyZW50LCBzZWxlY3Rvcikge1xuICAgIHZhciBlbCA9IHNtYXNoLmdldEFsbChwYXJlbnQsIHNlbGVjdG9yKTtcbiAgICBmb3IgKHZhciBpPTA7IGk8ZWwubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZWxbaV0uc3R5bGUuZGlzcGxheSA9ICcnO1xuICAgIH1cbn07XG4iLCJzbWFzaC5hamF4ID0ge307XG5cbnNtYXNoLmFqYXgueCA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAodHlwZW9mIFhNTEh0dHBSZXF1ZXN0ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICByZXR1cm4gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgfVxuICAgIHZhciB2ZXJzaW9ucyA9IFtcbiAgICAgICAgXCJNU1hNTDIuWG1sSHR0cC42LjBcIixcbiAgICAgICAgXCJNU1hNTDIuWG1sSHR0cC41LjBcIixcbiAgICAgICAgXCJNU1hNTDIuWG1sSHR0cC40LjBcIixcbiAgICAgICAgXCJNU1hNTDIuWG1sSHR0cC4zLjBcIixcbiAgICAgICAgXCJNU1hNTDIuWG1sSHR0cC4yLjBcIixcbiAgICAgICAgXCJNaWNyb3NvZnQuWG1sSHR0cFwiXG4gICAgXTtcbiAgICB2YXIgeGhyO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmVyc2lvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHhociA9IG5ldyBBY3RpdmVYT2JqZWN0KHZlcnNpb25zW2ldKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHhocjtcbn07XG5cbnNtYXNoLmFqYXguc2VuZCA9IGZ1bmN0aW9uICh1cmwsIGNhbGxiYWNrLCBtZXRob2QsIGRhdGEsIHJlc3BvbnNlVHlwZSwgYXN5bmMpIHtcbiAgICBpZiAoYXN5bmMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBhc3luYyA9IHRydWU7XG4gICAgfVxuICAgIHZhciB4ID0gc21hc2guYWpheC54KCk7XG4gICAgeC5yZXNwb25zZVR5cGUgPSByZXNwb25zZVR5cGU7XG4gICAgeC5vcGVuKG1ldGhvZCwgdXJsLCBhc3luYyk7XG4gICAgeC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG5cdFx0aWYgKHgucmVhZHlTdGF0ZSA9PSA0KSB7XG5cdFx0XHRpZiAoeC5zdGF0dXMgPT0gMjAwIHx8IHguc3RhdHVzID09IDIwMSkge1xuXHRcdFx0XHRjYWxsYmFjayAmJiBjYWxsYmFjayh4LnJlc3BvbnNlKTtcblx0XHRcdH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coeC5zdGF0dXMsIHgucmVzcG9uc2UpO1xuXHRcdFx0fVxuXHRcdH1cbiAgICB9O1xuICAgIGlmIChtZXRob2QgPT0gJ1BPU1QnKSB7XG4gICAgICAgIHguc2V0UmVxdWVzdEhlYWRlcignQ29udGVudC10eXBlJywgJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcpO1xuICAgIH1cbiAgICB4LnNlbmQoZGF0YSlcbn07XG5cbnNtYXNoLmFqYXguZ2V0ID0gZnVuY3Rpb24gKHVybCwgY2FsbGJhY2ssIGRhdGEsIHJlc3BvbnNlVHlwZSwgYXN5bmMpIHtcbiAgICB2YXIgcXVlcnkgPSBbXTtcbiAgICBmb3IgKHZhciBrZXkgaW4gZGF0YSkge1xuICAgICAgICBxdWVyeS5wdXNoKGVuY29kZVVSSUNvbXBvbmVudChrZXkpICsgJz0nICsgZW5jb2RlVVJJQ29tcG9uZW50KGRhdGFba2V5XSkpO1xuICAgIH1cbiAgICBzbWFzaC5hamF4LnNlbmQodXJsICsgKHF1ZXJ5Lmxlbmd0aCA/ICc/JyArIHF1ZXJ5LmpvaW4oJyYnKSA6ICcnKSwgY2FsbGJhY2ssICdHRVQnLCBudWxsLCByZXNwb25zZVR5cGUsICBhc3luYylcbn07XG5cbnNtYXNoLmFqYXgucG9zdCA9IGZ1bmN0aW9uICh1cmwsIGNhbGxiYWNrLCBkYXRhLCByZXNwb25zZVR5cGUsIGFzeW5jKSB7XG4gICAgdmFyIGRhdGFTdHI7XG4gICAgaWYgKGRhdGEpIHtcbiAgICAgICAgaWYgKHJlc3BvbnNlVHlwZSAhPSAnanNvbicpIHtcbiAgICAgICAgICAgIHZhciBxdWVyeSA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIGRhdGEpIHtcbiAgICAgICAgICAgICAgICBxdWVyeS5wdXNoKGVuY29kZVVSSUNvbXBvbmVudChrZXkpICsgJz0nICsgZW5jb2RlVVJJQ29tcG9uZW50KGRhdGFba2V5XSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGF0YVN0ciA9IHF1ZXJ5LmpvaW4oJyYnKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZGF0YVN0ciA9IEpTT04uc3RyaW5naWZ5KGRhdGEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNtYXNoLmFqYXguc2VuZCh1cmwsIGNhbGxiYWNrLCAnUE9TVCcsIGRhdGFTdHIsIHJlc3BvbnNlVHlwZSwgYXN5bmMpXG59O1xuIiwic21hc2guY2xhc3MgPSB7fTtcblxuc21hc2guY2xhc3MuYWRkID0gZnVuY3Rpb24oZWwsIGNsYXNzTmFtZSkge1xuICAgIGlmICghc21hc2guY2xhc3MuaGFzKGVsLCBjbGFzc05hbWUpKSB7XG4gICAgICAgIGVsLmNsYXNzTGlzdCA/IGVsLmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKSA6IGVsLmNsYXNzTmFtZSArPSAoJyAnICsgY2xhc3NOYW1lKTtcbiAgICB9XG59O1xuXG5zbWFzaC5jbGFzcy5yZW1vdmUgPSBmdW5jdGlvbihlbCwgY2xhc3NOYW1lKSB7XG4gICAgaWYgKHNtYXNoLmNsYXNzLmhhcyhlbCwgY2xhc3NOYW1lKSkge1xuICAgICAgICBlbC5jbGFzc0xpc3QgPyBlbC5jbGFzc0xpc3QucmVtb3ZlKGNsYXNzTmFtZSkgOiBlbC5jbGFzc05hbWUgPSBlbC5jbGFzc05hbWUucmVwbGFjZShjbGFzc05hbWUsICcnKTtcbiAgICB9XG59O1xuXG5zbWFzaC5jbGFzcy5oYXMgPSBmdW5jdGlvbihlbCwgY2xhc3NOYW1lKSB7XG4gICAgcmV0dXJuICgoXCIgXCIgKyBlbC5jbGFzc05hbWUgKyBcIiBcIikucmVwbGFjZSgvW1xcblxcdF0vZywgXCIgXCIpLmluZGV4T2YoXCIgXCIgKyBjbGFzc05hbWUgKyBcIiBcIikgPiAtMSk7XG59O1xuXG5zbWFzaC5jbGFzcy50b2dnbGUgPSBmdW5jdGlvbihlbCwgY2xhc3NOYW1lKSB7XG4gICAgc21hc2guY2xhc3MuaGFzKGVsLCBjbGFzc05hbWUpID8gc21hc2guY2xhc3MucmVtb3ZlKGVsLCBjbGFzc05hbWUpIDogc21hc2guY2xhc3MuYWRkKGVsLCBjbGFzc05hbWUpO1xufTtcbiIsInNtYXNoLmNvbmZpZyA9IHtcbiAgICBfdmFsdWVzXzoge1xuICAgICAgICBfc2lkZWJhcl9sb2NrXzogZmFsc2VcbiAgICB9XG59XG5cbnNtYXNoLmNvbmZpZy5pbml0ID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHYgPSBzbWFzaC5zdG9yYWdlLmdldCgnY29uZmlnJyk7XG4gICAgaWYgKHYpIHtcbiAgICAgICAgc21hc2guY29uZmlnLl92YWx1ZXNfID0gdjtcbiAgICB9XG59O1xuXG5zbWFzaC5jb25maWcuZ2V0ID0gZnVuY3Rpb24ob3B0aW9uKSB7XG4gICAgdmFyIG8gPSAnXycgKyBvcHRpb24gKyAnXyc7XG4gICAgaWYgKG8gaW4gc21hc2guY29uZmlnLl92YWx1ZXNfKSB7XG4gICAgICAgIHJldHVybiBzbWFzaC5jb25maWcuX3ZhbHVlc19bb107XG4gICAgfVxuICAgIHRocm93IG5ldyBzbWFzaC5FeGNlcHRpb24oJzAwMScsICdJbnZhbGlkIGNvbmZpZyBvcHRpb24gXCInICsgb3B0aW9uICsgJ1wiJyk7XG59O1xuXG5zbWFzaC5jb25maWcuc2V0ID0gZnVuY3Rpb24ob3B0aW9uLCB2YWx1ZSkge1xuICAgIHZhciBvID0gJ18nICsgb3B0aW9uICsgJ18nO1xuICAgIGlmICghbyBpbiBzbWFzaC5jb25maWcuX3ZhbHVlc18pIHtcbiAgICAgICAgdGhyb3cgbmV3IHNtYXNoLkV4Y2VwdGlvbignMDAxJywgJ0ludmFsaWQgY29uZmlnIG9wdGlvbiBcIicgKyBvcHRpb24gKyAnXCInKTtcbiAgICB9XG4gICAgc21hc2guY29uZmlnLl92YWx1ZXNfW29dID0gdmFsdWU7XG4gICAgc21hc2guc3RvcmFnZS5zZXQoJ2NvbmZpZycsIHNtYXNoLmNvbmZpZy5fdmFsdWVzXyk7XG59O1xuIiwic21hc2guRXhjZXB0aW9uID0gZnVuY3Rpb24gKHZhbHVlLCBtZXNzYWdlKSB7XG4gICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2U7XG4gICAgdGhpcy50b1N0cmluZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gJ1NtYXNoRXhjZXB0aW9uICcgKyB0aGlzLnZhbHVlICsgJzogJyArIHRoaXMubWVzc2FnZTtcbiAgICB9O1xufTtcbiIsInNtYXNoLmlucHV0ID0ge307XG5cbnNtYXNoLmlucHV0LmluaXQgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgaW5wdXRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5zbWFzaC1pbnB1dC5oYXMtZmxvYXRpbmctbGFiZWwgaW5wdXRcIik7XG4gICAgdmFyIGlucHV0O1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaW5wdXRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlucHV0ID0gaW5wdXRzW2ldO1xuICAgICAgICBzbWFzaC5jbGFzcy5yZW1vdmUoaW5wdXQucGFyZW50RWxlbWVudCwgJ2hhcy1mbG9hdGluZy1sYWJlbCcpO1xuICAgICAgICBzbWFzaC5jbGFzcy5hZGQoaW5wdXQucGFyZW50RWxlbWVudCwgJ2Zsb2F0aW5nLWxhYmVsJyk7XG5cbiAgICAgICAgdmFyIGxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKTtcbiAgICAgICAgbGFiZWwuaW5uZXJIVE1MID0gaW5wdXQucGxhY2Vob2xkZXI7XG4gICAgICAgIGlucHV0LnBhcmVudEVsZW1lbnQuYXBwZW5kQ2hpbGQobGFiZWwpO1xuICAgICAgICBpbnB1dC5vbmtleXVwID0gZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgdmFyIGwgPSB0aGlzLnBhcmVudEVsZW1lbnQucXVlcnlTZWxlY3RvcihcImxhYmVsXCIpO1xuICAgICAgICAgICAgaWYgKGwpIHtcbiAgICAgICAgICAgICAgICBpZiAoZS5zcmNFbGVtZW50LnZhbHVlICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgc21hc2guY2xhc3MuYWRkKGwsICdzaG93Jyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc21hc2guY2xhc3MucmVtb3ZlKGwsICdzaG93Jyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cbiAgICB2YXIgc2VsZWN0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc21hc2gtc2VsZWN0IHNlbGVjdFwiKTtcbiAgICB2YXIgc2VsZWN0O1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZWN0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBzZWxlY3QgPSBzZWxlY3RzW2ldO1xuICAgICAgICBpZiAoc21hc2guY2xhc3MuaGFzKHNlbGVjdC5wYXJlbnRFbGVtZW50LCAnaGFzLWZsb2F0aW5nLWxhYmVsJykpIHtcbiAgICAgICAgICAgIHNtYXNoLmNsYXNzLnJlbW92ZShzZWxlY3QucGFyZW50RWxlbWVudCwgJ2hhcy1mbG9hdGluZy1sYWJlbCcpO1xuICAgICAgICAgICAgc21hc2guY2xhc3MuYWRkKHNlbGVjdC5wYXJlbnRFbGVtZW50LCAnZmxvYXRpbmctbGFiZWwnKTtcbiAgICAgICAgICAgIHZhciBsYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJyk7XG4gICAgICAgICAgICBsYWJlbC5pbm5lckhUTUwgPSBzZWxlY3QuZ2V0QXR0cmlidXRlKCdwbGFjZWhvbGRlcicpO1xuICAgICAgICAgICAgc2VsZWN0LnBhcmVudEVsZW1lbnQuYXBwZW5kQ2hpbGQobGFiZWwpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gICAgICAgIGlucHV0LnR5cGUgPSBcInRleHRcIjtcbiAgICAgICAgaW5wdXQucGxhY2Vob2xkZXIgPSBzZWxlY3QuZ2V0QXR0cmlidXRlKCdwbGFjZWhvbGRlcicpO1xuICAgICAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoXCJyZWFkb25seVwiLCBcInJlYWRvbmx5XCIpO1xuICAgICAgICBzZWxlY3QucGFyZW50RWxlbWVudC5hcHBlbmRDaGlsZChpbnB1dCk7XG5cbiAgICAgICAgdmFyIG9wdGlvbnMgPSBzZWxlY3QucXVlcnlTZWxlY3RvckFsbChcIm9wdGlvblwiKTtcbiAgICAgICAgdmFyIHVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndWwnKTtcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBvcHRpb25zLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICB2YXIgb3B0aW9uID0gb3B0aW9uc1tqXTtcbiAgICAgICAgICAgIGlmIChvcHRpb24uZ2V0QXR0cmlidXRlKCd2YWx1ZScpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcbiAgICAgICAgICAgICAgICBsaS5zZXRBdHRyaWJ1dGUoXCJ2YWx1ZVwiLCBvcHRpb24udmFsdWUpO1xuICAgICAgICAgICAgICAgIGxpLmlubmVySFRNTCA9IG9wdGlvbi5pbm5lckhUTUw7XG4gICAgICAgICAgICAgICAgdWwuYXBwZW5kQ2hpbGQobGkpO1xuICAgICAgICAgICAgICAgIGxpLm9ubW91c2Vkb3duID0gZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdmFsID0gdGhpcy5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJyk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudDtcbiAgICAgICAgICAgICAgICAgICAgc21hc2guY2xhc3MucmVtb3ZlKHBhcmVudCwgJ2lzLWZvY3Vzc2VkJyk7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5vbm1vdXNlZG93biA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIHBhcmVudC5xdWVyeVNlbGVjdG9yKFwic2VsZWN0XCIpLnZhbHVlID0gdmFsO1xuICAgICAgICAgICAgICAgICAgICBwYXJlbnQucXVlcnlTZWxlY3RvcihcImlucHV0XCIpLnZhbHVlID0gdGhpcy5pbm5lckhUTUw7XG4gICAgICAgICAgICAgICAgICAgIHBhcmVudC5xdWVyeVNlbGVjdG9yKFwiaW5wdXRcIikuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50LnF1ZXJ5U2VsZWN0b3IoXCJpbnB1dFwiKS5vbmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHNlbGVjdC5wYXJlbnRFbGVtZW50LmFwcGVuZENoaWxkKHVsKTtcbiAgICAgICAgaW5wdXQub25mb2N1cyA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIHZhciBsID0gdGhpcy5wYXJlbnRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJsYWJlbFwiKTtcbiAgICAgICAgICAgIGlmIChsKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudmFsdWUgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICBzbWFzaC5jbGFzcy5hZGQobCwgJ3Nob3cnKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzbWFzaC5jbGFzcy5yZW1vdmUobCwgJ3Nob3cnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgc2VsZWN0LnBhcmVudEVsZW1lbnQub25jbGljayA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgc21hc2guY2xhc3MuYWRkKHRoaXMsICdpcy1mb2N1c3NlZCcpO1xuICAgICAgICAgICAgdmFyIHNlbGVjdCA9IHRoaXM7XG4gICAgICAgICAgICB3aW5kb3cub25tb3VzZWRvd24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImNsaWNrIG91dHNpZGVcIik7XG4gICAgICAgICAgICAgICAgd2luZG93Lm9ubW91c2Vkb3duID0gbnVsbDtcbiAgICAgICAgICAgICAgICBzbWFzaC5jbGFzcy5yZW1vdmUoc2VsZWN0LCAnaXMtZm9jdXNzZWQnKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG5cbiAgICB9XG59O1xuIiwic21hc2gucm91dGVyID0ge1xuICAgIF9fcGFyc2VSb3V0ZVJlZ2V4OiAveyguKj8pfS9pZyxcbiAgICBfX2R5bmFtaWNQYXJ0czogW10sXG4gICAgX19yb3V0ZXM6IHtcbiAgICAgICAgc3RhdGljOiBbXSxcbiAgICAgICAgZHluYW1pYzogW11cbiAgICB9XG59O1xuXG5zbWFzaC5yb3V0ZXIuYWRkID0gZnVuY3Rpb24ocGF0aCwgY2FsbGJhY2spIHtcbiAgICB2YXIgcm91dGUgPSBzbWFzaC5yb3V0ZXIucGFyc2VSb3V0ZShwYXRoKTtcbiAgICBpZiAocm91dGUucmVnZXgpIHtcbiAgICAgICAgcm91dGUuY2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgICAgICAgaWYgKCFzbWFzaC5yb3V0ZXIuX19yb3V0ZXMuZHluYW1pY1tyb3V0ZS5kZXB0aF0pIHtcbiAgICAgICAgICAgIHNtYXNoLnJvdXRlci5fX3JvdXRlcy5keW5hbWljW3JvdXRlLmRlcHRoXSA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIGlmICghc21hc2gucm91dGVyLl9fcm91dGVzLmR5bmFtaWNbcm91dGUuZGVwdGhdW3JvdXRlLm51bVZhcnNdKSB7XG4gICAgICAgICAgICBzbWFzaC5yb3V0ZXIuX19yb3V0ZXMuZHluYW1pY1tyb3V0ZS5kZXB0aF1bcm91dGUubnVtVmFyc10gPSBbXTtcbiAgICAgICAgfVxuICAgICAgICBzbWFzaC5yb3V0ZXIuX19yb3V0ZXMuZHluYW1pY1tyb3V0ZS5kZXB0aF1bcm91dGUubnVtVmFyc10ucHVzaChyb3V0ZSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgc21hc2gucm91dGVyLl9fcm91dGVzLnN0YXRpY1twYXRoXSA9IGNhbGxiYWNrO1xufTtcblxuc21hc2gucm91dGVyLnNldCA9IGZ1bmN0aW9uKHJvdXRlKSB7XG4gICAgd2luZG93Lmhpc3RvcnkucHVzaFN0YXRlKFwiXCIsIFwiXCIsIHJvdXRlKTtcbiAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3BvcHN0YXRlJykpO1xufTtcblxuc21hc2gucm91dGVyLnJlZGlyZWN0ID0gZnVuY3Rpb24ocm91dGUpIHtcbiAgICB3aW5kb3cubG9jYXRpb24gPSByb3V0ZTtcbn07XG5cbnNtYXNoLnJvdXRlci5oYW5kbGVOb3RGb3VuZCA9IGZ1bmN0aW9uKHJvdXRlKSB7XG4gICAgY29uc29sZS5sb2coXCJyb3V0ZTogXCIgKyBKU09OLnN0cmluZ2lmeShyb3V0ZSkgKyBcIiBkb2VzIG5vdCBleGlzdFwiKTtcbn07XG5cbnNtYXNoLnJvdXRlci5ydW4gPSBmdW5jdGlvbigpIHtcbiAgICB3aW5kb3cub25wb3BzdGF0ZSA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgIHNtYXNoLnJvdXRlci5leGVjdXRlKCk7XG4gICAgfTtcbiAgICBzbWFzaC5yb3V0ZXIuZXhlY3V0ZSgpO1xufVxuXG5zbWFzaC5yb3V0ZXIuZXhlY3V0ZSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBwYXRoID0gdGhpcy5nZXRQYXRoKCk7XG4gICAgaWYgKHRoaXMuX19yb3V0ZXMuc3RhdGljW3BhdGgucGF0aF0pIHtcbiAgICAgICAgdGhpcy5fX3JvdXRlcy5zdGF0aWNbcGF0aC5wYXRoXSgpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBkZXB0aCA9IHBhdGgucGF0aC5zcGxpdChcIi9cIikubGVuZ3RoLTE7XG4gICAgaWYgKHRoaXMuX19yb3V0ZXMuZHluYW1pY1tkZXB0aF0pIHtcbiAgICAgICAgdmFyIHJvdXRlO1xuICAgICAgICB2YXIgbWF0Y2hlcztcbiAgICAgICAgdmFyIGRhdGEgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgdmFyTnVtIGluIHRoaXMuX19yb3V0ZXMuZHluYW1pY1tkZXB0aF0pIHtcbiAgICAgICAgICAgIGZvciAodmFyIGl0ZW0gaW4gdGhpcy5fX3JvdXRlcy5keW5hbWljW2RlcHRoXVt2YXJOdW1dKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJvdXRlID0gdGhpcy5fX3JvdXRlcy5keW5hbWljW2RlcHRoXVt2YXJOdW1dW2l0ZW1dO1xuICAgICAgICAgICAgICAgIG1hdGNoZXMgPSBwYXRoLnBhdGgubWF0Y2gocm91dGUucmVnZXgpO1xuICAgICAgICAgICAgICAgIGlmICghbWF0Y2hlcykge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaT0wOyBpPHJvdXRlLm51bVZhcnM7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBkYXRhW3JvdXRlLnZhcnNbaV1dID0gbWF0Y2hlc1tpKzFdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByb3V0ZS5jYWxsYmFjayhkYXRhKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgc21hc2gucm91dGVyLmhhbmRsZU5vdEZvdW5kKHBhdGgpO1xufTtcblxuc21hc2gucm91dGVyLmdldFBhdGggPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJhXCIpO1xuICAgIGwuaHJlZiA9IHdpbmRvdy5sb2NhdGlvbjtcbiAgICByZXR1cm4ge2hvc3Q6IGwuaG9zdG5hbWUsIHBhdGg6IGwucGF0aG5hbWV9O1xufTtcblxuc21hc2gucm91dGVyLnBhcnNlUm91dGUgPSBmdW5jdGlvbihwYXRoKSB7XG4gICAgaWYgKHBhdGguc3Vic3RyaW5nKDAsMSkgIT0gXCIvXCIpIHtcbiAgICAgICAgcGF0aCA9IFwiL1wiICsgcGF0aDtcbiAgICB9XG4gICAgaWYgKHBhdGguc3Vic3RyaW5nKHBhdGgubGVuZ3RoLTIpID09IFwiL1wiKSB7XG4gICAgICAgIHBhdGggPSBcIi9cIiArIHBhdGg7XG4gICAgfVxuICAgIHZhciByb3V0ZSA9IHtcbiAgICAgICAgcGF0aDogcGF0aCxcbiAgICAgICAgZGVwdGg6IChwYXRoLnNwbGl0KFwiL1wiKS5sZW5ndGggLSAxKSxcbiAgICAgICAgdmFyczogW10sXG4gICAgICAgIG51bVZhcnM6IDBcbiAgICB9O1xuICAgIHNtYXNoLnJvdXRlci5fX2R5bmFtaWNQYXJ0cyA9IHBhdGgubWF0Y2goc21hc2gucm91dGVyLl9fcGFyc2VSb3V0ZVJlZ2V4KTtcbiAgICBpZiAoc21hc2gucm91dGVyLl9fZHluYW1pY1BhcnRzICE9IHVuZGVmaW5lZCAmJiBzbWFzaC5yb3V0ZXIuX19keW5hbWljUGFydHMgIT0gbnVsbCkge1xuICAgICAgICB2YXIgcmVnZXggPSBcIl5cIiArIHBhdGgucmVwbGFjZSgvXFwvL2lnLCBcIlxcXFwvXCIpICsgXCIkXCI7XG4gICAgICAgIGZvciAodmFyIGk9MDsgaTxzbWFzaC5yb3V0ZXIuX19keW5hbWljUGFydHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHJvdXRlLm51bVZhcnMrKztcbiAgICAgICAgICAgIHJvdXRlLnZhcnMucHVzaChzbWFzaC5yb3V0ZXIuX19keW5hbWljUGFydHNbaV0uc3Vic3RyaW5nKDEsIHNtYXNoLnJvdXRlci5fX2R5bmFtaWNQYXJ0c1tpXS5sZW5ndGgtMSkpO1xuICAgICAgICAgICAgcmVnZXggPSByZWdleC5yZXBsYWNlKHNtYXNoLnJvdXRlci5fX2R5bmFtaWNQYXJ0c1tpXSwgXCIoLio/KVwiKTtcbiAgICAgICAgfVxuICAgICAgICByb3V0ZS5yZWdleCA9IG5ldyBSZWdFeHAocmVnZXgsICdpJyk7XG4gICAgfVxuICAgIHJldHVybiByb3V0ZTtcbn07XG4iLCJzbWFzaC5zZWFyY2hib3ggPSB7XG4gICAgaV86IGZhbHNlXG59O1xuXG5zbWFzaC5zZWFyY2hib3guaW5pdCA9IGZ1bmN0aW9uKCkge1xuICAgIGlmIChzbWFzaC5zZWFyY2hib3guaV8pIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgc3NiID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zbWFzaC1zZWFyY2hib3ggaW5wdXRcIik7XG4gICAgaWYgKHNzYikge1xuICAgICAgICBzc2Iub25mb2N1cyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgc21hc2guY2xhc3MuYWRkKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc21hc2gtaGVhZGVyXCIpLCAnaXMtZm9jdXNzZWQnKTtcbiAgICAgICAgfTtcbiAgICAgICAgc3NiLm9uYmx1ciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgc21hc2guY2xhc3MucmVtb3ZlKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc21hc2gtaGVhZGVyXCIpLCAnaXMtZm9jdXNzZWQnKTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgc21hc2guc2VhcmNoYm94LmlfID0gdHJ1ZTtcbn07XG4iLCJzbWFzaC5zaWRlYmFyID0ge1xuICAgIGlfOiBmYWxzZVxufTtcblxuc21hc2guc2lkZWJhci5pbml0ID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKHNtYXNoLnNpZGViYXIuaV8pIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgc2libCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc21hc2gtc2lkZWJhciAubG9ja1wiKTtcbiAgICBpZiAoIXNpYmwpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHNpYmwub25jbGljayA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgc21hc2guc2lkZWJhci50b2dnbGVMb2NrKCk7XG4gICAgICAgIH07XG4gICAgfVxuICAgIHZhciBzaWIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNtYXNoLXNpZGViYXJcIik7XG4gICAgc21hc2guY2xhc3MuYWRkKHNpYiwgJ2lzLXVubG9ja2VkJyk7XG4gICAgc21hc2guc2lkZWJhci5pXyA9IHRydWU7XG4gICAgaWYgKHNtYXNoLmNvbmZpZy5nZXQoJ3NpZGViYXJfbG9jaycpKSB7XG4gICAgICAgIHNtYXNoLnNpZGViYXIudG9nZ2xlTG9jaygpO1xuICAgIH1cbn07XG5cbnNtYXNoLnNpZGViYXIudG9nZ2xlTG9jayA9IGZ1bmN0aW9uKCkge1xuICAgIGlmICghc21hc2guc2lkZWJhci5pXykge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHNtYXNoLmNsYXNzLnRvZ2dsZShkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNtYXNoLXNpZGViYXIgLmxvY2tcIiksICd1bmxvY2snKTtcbiAgICBzbWFzaC5jbGFzcy50b2dnbGUoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zbWFzaC1zaWRlYmFyXCIpLCAnaXMtdW5sb2NrZWQnKTtcbiAgICBzbWFzaC5jb25maWcuc2V0KCdzaWRlYmFyX2xvY2snLCAhc21hc2guY2xhc3MuaGFzKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc21hc2gtc2lkZWJhclwiKSwgJ2lzLXVubG9ja2VkJykpO1xufTtcbiIsInNtYXNoLnN0b3JhZ2UgPSB7fTtcblxuc21hc2guc3RvcmFnZS5zZXQgPSBmdW5jdGlvbihuYW1lLCB2YWx1ZSkge1xuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKG5hbWUsIEpTT04uc3RyaW5naWZ5KHZhbHVlKSk7XG59O1xuXG5zbWFzaC5zdG9yYWdlLmdldCA9IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICB2YXIgaSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKG5hbWUpO1xuICAgIGlmICghaSkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICByZXR1cm4gSlNPTi5wYXJzZShpKTtcbn07XG5cbnNtYXNoLnN0b3JhZ2UuY2xlYXIgPSBmdW5jdGlvbigpIHtcbiAgICBsb2NhbFN0b3JhZ2UuY2xlYXIoKTtcbn07XG4iLCJzbWFzaC53b3Jrc3BhY2UgPSB7XG4gICAgX3dzXzogdW5kZWZpbmVkLFxuICAgIF9oZHJfOiB1bmRlZmluZWQsXG4gICAgX3NiXzogdW5kZWZpbmVkXG59O1xuXG5zbWFzaC53b3Jrc3BhY2UuaW5pdCA9IGZ1bmN0aW9uKCkge1xuICAgIHNtYXNoLndvcmtzcGFjZS5fd3NfID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zbWFzaC13b3Jrc3BhY2VcIik7XG4gICAgaWYgKCFzbWFzaC53b3Jrc3BhY2UuX3dzXykge1xuICAgICAgICByZXR1cm5cbiAgICB9XG4gICAgc21hc2gud29ya3NwYWNlLl9oZHJfID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zbWFzaC1oZWFkZXJcIik7XG4gICAgaWYgKHNtYXNoLndvcmtzcGFjZS5faGRyXykge1xuICAgICAgICBzbWFzaC5jbGFzcy5hZGQoc21hc2gud29ya3NwYWNlLl93c18sICdoYXMtaGVhZGVyJyk7XG4gICAgfVxuICAgIHNtYXNoLndvcmtzcGFjZS5fc2JfID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zbWFzaC13b3Jrc3BhY2UgLnNtYXNoLXNpZGViYXJcIik7XG4gICAgaWYgKHNtYXNoLndvcmtzcGFjZS5fc2JfKSB7XG4gICAgICAgIHNtYXNoLmNsYXNzLmFkZChzbWFzaC53b3Jrc3BhY2UuX3dzXywgJ2hhcy1zaWRlYmFyJyk7XG4gICAgfVxufTtcblxuc21hc2gud29ya3NwYWNlLmFkZFRhYiA9IGZ1bmN0aW9uKGlkLCB0aXRsZSwgY29udGVudCkge1xuICAgIGlmICghc21hc2guZ2V0KGRvY3VtZW50LCAnLnNtYXNoLXRhYi1wYW5lJykpIHtcbiAgICAgICAgdmFyIHBhbmVsID0gc21hc2guZ2V0KGRvY3VtZW50LCAnLnNtYXNoLXBhbmVsJyk7XG4gICAgICAgIGlmICghcGFuZWwpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdUbyBhZGQgYSB0YWIgdGhlcmUgbmVlZHMgdG8gYmUgYSBwYW5lbCcpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHBhbmVsLmlubmVySFRNTCA9ICc8ZGl2IGNsYXNzPVwic21hc2gtdGFiLXBhbmVcIj48ZGl2IGNsYXNzPVwic21hc2gtdGFic1wiPjwvZGl2PjxkaXYgY2xhc3M9XCJzbWFzaC1wYW5lc1wiPjwvZGl2PjwvZGl2Pic7XG4gICAgfVxuICAgIHZhciB0YWJzID0gc21hc2guZ2V0KGRvY3VtZW50LCAnLnNtYXNoLXRhYi1wYW5lIC5zbWFzaC10YWJzJyk7XG4gICAgdmFyIHBhbmVzQ29udGFpbmVyID0gc21hc2guZ2V0KGRvY3VtZW50LCAnLnNtYXNoLXRhYi1wYW5lIC5zbWFzaC1wYW5lcycpO1xuXG4gICAgc21hc2guaGlkZShwYW5lc0NvbnRhaW5lciwgXCIuc21hc2gtcGFuZVwiKTtcbiAgICBpZiAoYWN0aXZlID0gc21hc2guZ2V0KHRhYnMsICcuc21hc2gtdGFiLmFjdGl2ZScpKSB7XG4gICAgICAgIHNtYXNoLmNsYXNzLnJlbW92ZShhY3RpdmUsICdhY3RpdmUnKTtcbiAgICB9XG4gICAgdGFicy5pbm5lckhUTUwgPSB0YWJzLmlubmVySFRNTCArICc8ZGl2IGNsYXNzPVwic21hc2gtdGFiIGFjdGl2ZVwiIGRhdGEtaWQ9XCInICsgaWQgKyAnXCI+JyArIHRpdGxlICsgJzxpIGNsYXNzPVwibWF0ZXJpYWwtaWNvbnMgY2xvc2VcIj5jbG9zZTwvaT48L2Rpdj4nO1xuICAgIHBhbmVzQ29udGFpbmVyLmlubmVySFRNTCA9IHBhbmVzQ29udGFpbmVyLmlubmVySFRNTCArICc8ZGl2IGNsYXNzPVwic21hc2gtcGFuZVwiIGRhdGEtaWQ9XCInICsgaWQgKyAnXCI+JyArIGNvbnRlbnQgKyAnPC9kaXY+JztcbiAgICBpZiAodGVzdCA9IHNtYXNoLmdldCh0YWJzLCAnLnNtYXNoLXRhYi5hY3RpdmUnKSkge1xuICAgICAgICBjb25zb2xlLmxvZygndGVzdCAxJyk7XG4gICAgICAgIHRlc3Qub25jbGljayA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCd0ZXN0Jyk7XG4gICAgICAgICAgICBpZiAoYWN0aXZlID0gc21hc2guZ2V0KHRhYnMsICcuc21hc2gtdGFiLmFjdGl2ZScpKSB7XG4gICAgICAgICAgICAgICAgc21hc2guY2xhc3MucmVtb3ZlKGFjdGl2ZSwgJ2FjdGl2ZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc21hc2guY2xhc3MuYWRkKHRoaXMsICdhY3RpdmUnKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG4iXX0=
